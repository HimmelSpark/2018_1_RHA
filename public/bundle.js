!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=80)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.__instance)return e.__instance;this.listeners={},e.__instance=this}return r(e,[{key:"on",value:function(e,t){var n=this;return this.listeners[e]=this.listeners[e]||[],this.listeners[e].push(t),function(){n.off(e,t)}}},{key:"off",value:function(e,t){Array.isArray(this.listeners[e])&&(this.listeners[e]=this.listeners[e].filter(function(e){return e!==t}))}},{key:"emit",value:function(e,t){Array.isArray(this.listeners[e])&&this.listeners[e].forEach(function(n){n({event:e,payload:t})})}}]),e}();t.default=new i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(20)),o=a(n(12));function a(e){return e&&e.__esModule?e:{default:e}}var u=null,s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.email=t.email,this.username=t.username,this.rating=t.rating}return r(e,null,[{key:"auth",value:function(){return new Promise(function(t,n){i.default.get(o.default.userAPIMethods.user,function(r,i){if(r)return 401===r.status?(u=null,t(null)):n(r);i.then(function(n){u=new e(n.data),t(u)})})})}},{key:"isAuthorized",value:function(){return!!u}},{key:"getCurUser",value:function(){return u}},{key:"signIn",value:function(t){return new Promise(function(n,r){i.default.post(o.default.userAPIMethods.login,t,function(t,i){if(t)return r(t);console.log(i),n(e.auth())})})}},{key:"signUp",value:function(t){return new Promise(function(n,r){i.default.post(o.default.userAPIMethods.signup,t,function(t,i){if(t)return r(t);console.log(i),n(e.auth())})})}},{key:"logout",value:function(){return new Promise(function(t,n){i.default.post(o.default.userAPIMethods.logout,{},function(r,i){if(r)return n(r);console.log(i),t(e.auth())})})}},{key:"update",value:function(t){return new Promise(function(n,r){i.default.post(o.default.userAPIMethods.updateUser,t,function(t,i){if(t)return r(t);console.log(i),n(e.auth())})})}},{key:"uploadAvatar",value:function(e){return new Promise(function(t,n){i.default.post(o.default.userAPIMethods.updateAvatar,e,function(e,t){if(e)return n(e);console.log(t)})})}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),a=(r=o)&&r.__esModule?r:{default:r};var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a.default.isAuthorized()}return i(e,[{key:"render",value:function(){}},{key:"allowed",value:function(){return!1}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(29);var o=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.__instance)return e.__instance;this.root=t,this.startRoot=document.getElementById("start"),this.gameRoot=document.getElementById("game"),this.map={},this.global=n,this.active=null,e.__instance=this}return r(e,[{key:"add",value:function(e,t){return this.map[e]=new t(this.root),this}},{key:"open",value:function(e){console.log("open");var t=this.map[e],n=void 0;if("/singleplayer"===e||"/multiplayer"===e?(console.log("if"),n=this.gameRoot,this.startRoot.hidden=!0,n.hidden=!1):(console.log("else"),n=this.root,this.startRoot.hidden=!1,this.gameRoot.hidden=!0),console.log("view ",e,"is allowed: ",t.allowed()),!t.allowed())return window.history.replaceState(null,"","/"),void this.open("/");window.location.pathname!==e&&window.history.pushState(null,"",e),i.sectionSwitcher.changeSection(t.render(),n)}},{key:"start",value:function(){window.addEventListener("popstate",function(){this.open(window.location.pathname)}.bind(this)),this.root.addEventListener("click",function(e){"a"===e.target.tagName.toLowerCase()&&(e.preventDefault(),window.history.pushState(null,"",e.target.href),this.open(e.target.pathname))}.bind(this)),console.log(window.location.pathname),this.open(window.location.pathname)}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(9),a=(r=o)&&r.__esModule?r:{default:r};var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n.status=!0,n.wrapper=document.createElement("div");var r="input";return"submit"===e.type&&(r="button"),n.wrapper.innerHTML+=generateInput({type:e.type,placeholder:e.placeholder,value:e.value,id:e.id,error_id:e.id.concat("_error"),CLASS:r}),n.ErrorElement=n.wrapper.getElementsByTagName("div")[0],n.InputElement=n.wrapper.getElementsByTagName("input")[0],n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),i(t,[{key:"render",value:function(){return this.wrapper}},{key:"getState",value:function(){return this.status}},{key:"getData",value:function(){return this.InputElement.value}},{key:"getFormData",value:function(){return this.InputElement}},{key:"setError",value:function(e){e?(this.status=!1,this.ErrorElement.innerHTML=e,this.InputElement.classList.add("input__error")):(this.status=!0,this.ErrorElement.style.display="none",this.InputElement.classList.remove("input__error"))}},{key:"setOnInputChange",value:function(e){this.InputElement.addEventListener("change",function(t){t.preventDefault(),e()})}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(9),a=(r=o)&&r.__esModule?r:{default:r};var u=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.formElement=document.createElement("form"),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),i(t,[{key:"render",value:function(){}},{key:"reset",value:function(){this.formElement.reset()}},{key:"setOnSubmit",value:function(){}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GameModes={singleplayer:1,multiplayer:2}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={DEFAULT:1,READY:2,DISABLED:3,WON:4,LOSE:5}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"checkMail",value:function(e){var t=e.getData();!1===/([\w-]+)@([\w-]+)(\.[\w]+)/.test(t)?e.setError("incorrect email"):e.setError(null)}},{key:"checkName",value:function(e){var t=e.getData();/^[a-zA-Z0-9_-]{3,16}$/.test(t)?e.setError(null):e.setError("incorrect name")}},{key:"checkPass",value:function(e){e.getData().length<8?e.setError("too short password"):e.setError(null)}},{key:"checkConfirm",value:function(e,t){e.getData()!==t.getData()?t.setError("passwords do not match"):t.setError(null)}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"render",value:function(){}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.animate=function(e,t){var n=performance.now();requestAnimationFrame(function r(i){var o=i-n;o>t&&(o=t),e(o),o<t&&requestAnimationFrame(r)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(7),a=(r=o)&&r.__esModule?r:{default:r},u=n(17);var s=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.score=0,this.resources=0,this.canvas=r,this.allRegions=null,this.img=i,this.regions=[],this.status=a.default.DISABLED,this.color=n,this.name=t}return i(e,[{key:"setAllRegtions",value:function(e){this.allRegions=e}},{key:"init",value:function(){}},{key:"isTheRegionOfPlayer",value:function(e){for(var t=0;t<this.regions.length;++t)if(this.regions[t].name===e.name)return!0;return!1}},{key:"addRegion",value:function(e){e.area.setColor(this.color),(0,u.renderScene)(this.canvas,this.allRegions,this.img),e.area.reColor(this.color),e.owner=this,this.regions.push(e)}},{key:"delRegion",value:function(e){for(var t=0;t<this.regions.length;++t)this.regions[t]===e&&this.regions.splice(t,1);0===this.regions.length&&(this.status=a.default.LOSE)}},{key:"setStatus",value:function(e){this.status=e}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={serverUrl:"https://rha-backend.herokuapp.com/",userAPIMethods:{login:"users/auth",signup:"users/create",logout:"users/logout",user:"users/info",updateUser:"users/chpwd",leaderBoard:"users/rating",updateAvatar:"users/chava"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(9),a=(r=o)&&r.__esModule?r:{default:r};var u=function(e){function t(e,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.buttonWrapper=document.createElement("div"),i.buttonElement=document.createElement("button"),i.buttonElement.classList.add("btn-style"),i.buttonElement.classList.add("button"),i.buttonElement.innerHTML=n,i.buttonElement.type=e,r&&r.appendChild(i.buttonWrapper),i.buttonWrapper.classList.add("page-button"),i.buttonWrapper.appendChild(i.buttonElement),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),i(t,[{key:"render",value:function(){return this.buttonWrapper}},{key:"hide",value:function(){this.buttonWrapper.classList.add("hidden")}},{key:"show",value:function(){this.buttonWrapper.classList.remove("hidden")}},{key:"setOnClick",value:function(e){this.buttonElement.addEventListener("click",function(t){t.preventDefault(),e()})}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=1e3,o=610,a=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.__instance)return e.__instance;e.__instance=this,this.game_canvas=t,this.xSize=t.width/i,this.ySize=t.height/o,this.lengthSide=90,this.allowedCoord=[{name:"A",x:365*this.xSize,y:345*this.ySize,allowed:!0,neighbour:["B","C","D"]},{name:"B",x:(325+2*this.lengthSide)*this.xSize,y:(339-.86*this.lengthSide)*this.ySize,allowed:!0,neighbour:["A","C","D","E"]},{name:"C",x:365*this.xSize,y:(339-.86*this.lengthSide*2)*this.ySize,allowed:!0,neighbour:["A","B"]},{name:"D",x:(325+2*this.lengthSide)*this.xSize,y:(345+.86*this.lengthSide)*this.ySize,allowed:!0,neighbour:["A","B","E"]},{name:"E",x:(329+2*this.lengthSide+136)*this.xSize,y:343*this.ySize,allowed:!0,neighbour:["B","D"]}]}return r(e,[{key:"reSize",value:function(e){this.xSize=e.width/i,this.ySize=e.height/o,this.allowedCoord=[{name:"A",x:365*this.xSize,y:345*this.ySize,allowed:!0,neighbour:["B","C","D"]},{name:"B",x:(321+2*this.lengthSide)*this.xSize,y:(345-.86*this.lengthSide)*this.ySize,allowed:!0,neighbour:["A","C","D","E"]},{name:"C",x:365*this.xSize,y:(345-.86*this.lengthSide*2)*this.ySize,allowed:!0,neighbour:["A","B"]},{name:"D",x:(321+2*this.lengthSide)*this.xSize,y:(345+.86*this.lengthSide)*this.ySize,allowed:!0,neighbour:["A","B","E"]},{name:"E",x:(321+2*this.lengthSide+136)*this.xSize,y:345*this.ySize,allowed:!0,neighbour:["B","D"]}]}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=(r=o)&&r.__esModule?r:{default:r};var u=function(){function e(){var t=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.__instance)return e.__instance;var n="wss://rha-backend.herokuapp.com/multiplayer/rand";this.ws=new WebSocket(n),this.ws.onopen=function(e){console.log("WebSocket on address "+n+" opened"),a.default.emit("connected",{}),t.ws.onmessage=t.handleMessage.bind(t),t.ws.onclose=function(e){console.log(e),console.log("WebSocket closed")}},e.__instance=this}return i(e,[{key:"handleMessage",value:function(e){var t=e.data;console.log("got message ",t);try{var n=JSON.parse(t);a.default.emit(n.class,n)}catch(e){console.error("smth went wront in handleMessage: ",e)}}},{key:"send",value:function(e,t){console.log("sent message: type - ",e," data - ",t),this.ws.send(JSON.stringify({class:e,payload:t}))}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(11)),o=u(n(0)),a=u(n(48));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r,i));return o.listeners(),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"listeners",value:function(){var e=this;o.default.on("bot-move",function(t){if(t.payload.name===e.name){for(var n=[],r=0;r<e.regions.length;r++)0!==e.regions[r].neighbour.length&&n.push(e.regions[r]);var i=(0,a.default)(0,n.length-1);o.default.emit("bot-attack",{from:n[i],to:n[i].neighbour[(0,a.default)(0,n[i].neighbour.length-1)]}),setTimeout(function(){o.default.emit("bot-change-move","bot")},1e3)}})}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renderScene=function(e,t,n){var r=e.getContext("2d");r.clearRect(0,0,e.width,e.height),r.drawImage(n,0,0,e.width,e.height),t.forEach(function(e){e.renderHex()})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(11)),o=u(n(7)),a=u(n(0));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r,i));return a.status=o.default.DEFAULT,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"delRegion",value:function(e){for(var t=0;t<this.regions.length;++t)this.regions[t]===e&&this.regions.splice(t,1);0===this.regions.length&&(this.status=o.default.LOSE,a.default.emit("gameover",{}))}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=g(n(18)),o=g(n(16)),a=g(n(47)),u=g(n(44)),s=g(n(38)),l=g(n(37)),c=g(n(0)),f=n(6),d=g(n(15)),h=g(n(1)),p=g(n(34));function g(e){return e&&e.__esModule?e:{default:e}}var m=function(){function e(t,n,r,g,m){var v=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listeners={},e.__instance=this,this.mode=t,this.game_canvas=n,this.coordinate=r,this.game_ctx=this.game_canvas.getContext("2d"),this.img=m,this.scene=null,this.controller=new s.default(this.game_canvas,g,this.mode),console.log(this.mode),this.mode===f.GameModes.singleplayer?(this.players=[new i.default("A","rgba(0,255,127,0.4)",this.game_canvas,this.img),new o.default("B","rgba(0,0,205,0.4)",this.game_canvas,this.img),new o.default("C","rgba(255,69,0,0.4)",this.game_canvas,this.img),new o.default("D","rgba(139,125,107,0.4)",this.game_canvas,this.img),new o.default("E","rgba(255,165,0,0.4)",this.game_canvas,this.img)],this.regions=[],this.players.forEach(function(e,t,n){v.regions.push(new a.default(e.name,e,v.game_canvas,v.coordinate,1e3*(n.length-t)))}),this.players.forEach(function(e){e.setAllRegtions(v.regions)}),this.regions.forEach(function(e){e.setGlobalRegions(v.regions)}),this.scene=new l.default(this.game_canvas,this.players,this.regions,this.mode),this.manager=new u.default(this.controller,this.game_canvas,this.regions,this.img,this.mode)):(this.Ws=new d.default,c.default.on("connected",function(){v.Ws.send("JoinGame$Request",{}),c.default.on("InitGame$Request",function(e){var t=e.payload,n=h.default.getCurUser().username,r=void 0;t.players.forEach(function(e,t){e===n&&(r=t+1)}),v.players=[],v.regions=[],v.botPlayer=new o.default("bot","rgba(0,0,205,0.4)",v.game_canvas,v.img),t.map.forEach(function(e,o){if(e.owner===r){var u=new i.default(n,"rgba(0,255,127,0.4)",v.game_canvas,v.img);v.players.push(u);var s=new a.default(n,u,v.game_canvas,v.coordinate,e.units);v.regions.push(s)}else if(0===e.owner){var l=new a.default(String(o),v.botPlayer,v.game_canvas,v.coordinate,0);v.regions.push(l)}else t.players.forEach(function(t,n){if(e.owner===n+1){console.log("in else"),v.webPlayer=new p.default(t,"rgba(255,69,0,0.4)",v.game_canvas,v.img),v.players.push(v.webPlayer);var r=new a.default(t,v.webPlayer,v.game_canvas,v.coordinate,e.units);v.regions.push(r)}})}),v.players.forEach(function(e){e.setAllRegtions(v.regions)}),console.log(n),console.log(t),v.scene=new l.default(v.game_canvas,v.players,v.regions,v.mode),v.manager=new u.default(v.controller,v.game_canvas,v.regions,v.img,v.mode),v.start()})}))}return r(e,[{key:"start",value:function(){this.controller.start(),this.scene.onListeners(),this.manager.start(),c.default.emit("start-game",{})}},{key:"destroy",value:function(){this.controller.stop(),this.manager.destroy()}}]),e}();t.default=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(12),a=(r=o)&&r.__esModule?r:{default:r};var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"get",value:function(e,t){return this.request("GET",e).then(function(e){if(200===e.status)try{t(null,e.json())}catch(e){console.error("get error: ",e)}else t(e,null)})}},{key:"post",value:function(e,t,n){return this.request("POST",e,t).then(function(e){if(e.status<300)try{n(null,e.json())}catch(e){console.error("post error: ",e),n(e)}else n(e)})}},{key:"request",value:function(e,t,n){var r=new Headers;"POST"===e&&"users/chava"!==t&&r.append("Content-Type","application/json; charset=utf-8");var i={method:e,headers:r,body:n,credentials:"include",mode:"cors"};return fetch(""+a.default.serverUrl+t,i)}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=c(n(2)),a=c(n(19)),u=c(n(0)),s=c(n(14)),l=n(6);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.parent=document.getElementById("game"),e.wrapper=document.createElement("div"),e.wrapper.classList.add("wrapper"),e.wrapper.innerHTML+=generateCanvas({width:.7*window.innerWidth,height:.525*window.innerWidth*.83,id:"game-canvas"}),e.height_canv=.83*window.innerHeight,e.parent.appendChild(e.wrapper),e.game_canvas=document.getElementById("game-canvas"),e.ctx=e.game_canvas.getContext("2d"),e.game_canvas.style.marginTop=String(100-100*e.game_canvas.height/e.height_canv)/2+"%",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),i(t,[{key:"render",value:function(){var e=this;return this.img=new Image,this.img.src="/map.png",this.load=new Promise(function(t){e.img.onload=function(){t(e.ctx.drawImage(e.img,0,0,e.game_canvas.width,e.game_canvas.height))}}),this.load.then(function(){e.setWindowResizeHandler(),e.coordinate=new s.default(e.game_canvas),e.changeBut=e.wrapper.getElementsByClassName("change")[0],e.game=new a.default(l.GameModes.singleplayer,e.game_canvas,e.coordinate,e.changeBut,e.img),e.game.start()}),u.default.on("gameover",function(){alert("gameover"),e.game.destroy(),history.go("/singleplayer")}),this.wrapper}},{key:"allowed",value:function(){return!0}},{key:"computeCanvasSize",value:function(){return[.7*window.innerWidth,.525*window.innerWidth*.83]}},{key:"setWindowResizeHandler",value:function(){var e=this;return window.addEventListener("resize",function(){e.game_canvas.width,e.game_canvas.height;var t=e.computeCanvasSize(),n=r(t,2);e.game_canvas.width=n[0],e.game_canvas.height=n[1],e.ctx.drawImage(e.img,0,0,e.game_canvas.width,e.game_canvas.height),e.coordinate.reSize(e.game_canvas),e.game_canvas.style.marginTop=String(100-100*e.game_canvas.height/e.height_canv)/2+"%",u.default.emit("resize-for-draw",{})}),this}}]),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(2)),o=s(n(0)),a=s(n(3)),u=s(n(1));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.sign(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"render",value:function(){return this.menu=document.createElement("div"),this.attrsActive=[{title:"singleplayer",href:"/singleplayer"},{title:"multiplayer",href:"/multiplayer"},{title:"profile",href:"/profile"},{title:"rating",href:"/rating"}],this.attrPassive=[{title:"singleplayer",href:"/singleplayer"},{title:"Sign In",href:"/login"},{title:"Sign Up",href:"/register"}],u.default.isAuthorized()?(this.menu.innerHTML=generateMenu({attrs:this.attrsActive}),this.logout=document.createElement("a"),this.logout.setAttribute("href","/"),this.logout.innerText="logout",this.logout.addEventListener("click",function(e){e.preventDefault(),o.default.emit("logout",null)}),this.logoutWrapper=document.createElement("div"),this.logoutWrapper.classList.add("button"),this.logoutWrapper.appendChild(this.logout),this.menu.appendChild(this.logoutWrapper)):this.menu.innerHTML=generateMenu({attrs:this.attrPassive}),this.menu}},{key:"allowed",value:function(){return!0}},{key:"sign",value:function(){var e=this;o.default.on("user:authorized",function(){e.allow=!0,(new a.default).open("/menu")}),o.default.on("user:unauthorized",function(){e.allow=!1}),o.default.on("menu:hide",function(){e.hide()})}},{key:"hide",value:function(){this.menu.setAttribute("hidden","hidden")}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(5)),o=u(n(4)),a=u(n(8));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"getData",value:function(){var e=this.Email.getData(),t=this.Password.getData();return""===e||""===t?null:{email:e,password:t}}},{key:"render",value:function(){var e=this;return this.Email=new o.default({type:"text",placeholder:"email",id:"loginEmail"}),this.Password=new o.default({type:"password",placeholder:"password",id:"loginPassword"}),this.InputSubmit=new o.default({type:"submit",value:"Sign In",id:"loginSubmit"}),this.Email.setOnInputChange(function(){a.default.checkMail(e.Email)}),this.Password.setOnInputChange(function(){a.default.checkPass(e.Password)}),this.formElement.appendChild(this.Email.render()),this.formElement.appendChild(this.Password.render()),this.formElement.appendChild(this.InputSubmit.render()),this.formElement}},{key:"setOnSubmit",value:function(e){this.formElement.addEventListener("submit",function(t){t.preventDefault(),e()})}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(2)),o=s(n(23)),a=s(n(0)),u=s(n(1));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.sign(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"render",value:function(){var e=this;return this.login=document.createElement("div"),this.login.innerHTML=generateLogin(),this.after=this.login.getElementsByClassName("button")[0],this.loginForm=new o.default,this.login.firstChild.insertBefore(this.loginForm.render(),this.after),this.loginForm.setOnSubmit(function(){var t=e.loginForm.getData();if(null!==t){var n=JSON.stringify(t);console.log(n),a.default.emit("user:login",n)}else e.loginForm.Email.setError("empty fields")}),this.login}},{key:"allowed",value:function(){return!u.default.isAuthorized()}},{key:"sign",value:function(){var e=this;a.default.on("login-error",function(t){e.loginForm.Email.setError(t.payload)})}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(20)),o=l(n(12)),a=l(n(0)),u=l(n(3)),s=l(n(1));function l(e){return e&&e.__esModule?e:{default:e}}var c=new(function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.__instance)return e.__instance;a.default.on("user:signup",function(e){var t=e.payload;s.default.signUp(t).then(function(){(new u.default).open("/")}).catch(function(e){a.default.emit("signup-error",e)})}),a.default.on("logout",function(){s.default.logout().then(function(){(new u.default).open("/")}).catch(function(e){a.default.emit("logout-error",e)})}),a.default.on("user:login",function(e){var t=e.payload;s.default.signIn(t).then(function(){(new u.default).open("/")}).catch(function(e){a.default.emit("login-error",e)})}),a.default.on("user:update",function(e){var t=e.payload;s.default.update(t).then(function(){(new u.default).open("/")}).catch(function(e){a.default.emit("update-error",e)})}),a.default.on("user:avatarUpload",function(e){var t=e.payload;console.log(t),s.default.uploadAvatar(t).then(function(){(new u.default).open("/profile")}).catch(function(e){console.log(e)})}),e.__instance=this}return r(e,[{key:"rating",value:function(e,t){return i.default.get(o.default.userAPIMethods.leaderBoard+"/"+e.toString(),t)}}]),e}());t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(2)),o=s(n(25)),a=(s(n(13)),s(n(0))),u=(s(n(3)),s(n(1)));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.page=1,e.sign(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"render",value:function(){var e=this;return this.rating=document.createElement("div"),this.rating.innerHTML="",this.paginationWrap=document.createElement("div"),this.paginationWrap.classList.add("pagination"),this.prevButt=document.createElement("a"),this.prevButt.innerText="<",this.prevButt.addEventListener("click",function(t){t.preventDefault(),e.rating.removeChild(e.rating.firstChild),e.page--,e.prevButt.hidden=1===e.page,e.nextButt.hidden=!1,e.load(e.page)}),this.nextButt=document.createElement("a"),this.nextButt.innerText=">",this.nextButt.addEventListener("click",function(t){t.preventDefault(),e.rating.removeChild(e.rating.firstChild),e.page++,1!==e.page&&(e.prevButt.hidden=!1),e.load(e.page,function(t){t&&(e.nextButt.hidden=!0,e.lastPage=document.createElement("div"),e.lastPage.innerText="This is the last page",e.rating.insertBefore(e.lastPage,e.rating.firstChild))})}),this.prevButt.hidden=1===this.page,this.paginationWrap.appendChild(this.prevButt),this.paginationWrap.appendChild(this.nextButt),this.backButtWrap=document.createElement("div"),this.backButtWrap.classList.add("button"),this.backButtWrap.classList.add("back-button"),this.backButt=document.createElement("a"),this.backButt.setAttribute("href","/"),this.backButt.innerText="Back to menu",this.backButtWrap.appendChild(this.backButt),this.load(1,function(){}),this.rating.appendChild(this.paginationWrap),this.rating.appendChild(this.backButtWrap),this.rating}},{key:"load",value:function(e,t){var n=this;console.log(e),o.default.rating(e,function(r,i){if(r)return console.error(r),void t(!0);console.log(r,i),i.then(function(t){n.table=document.createElement("div"),n.table.innerHTML=generateRating({data:t[0],user:t[1][0],pages:t[2][0],page:e}),n.rating.insertBefore(n.table,n.rating.firstChild)})})}},{key:"sign",value:function(){var e=this;a.default.on("user:authorized",function(t){e.allowed=!0}),a.default.on("user:unauthorized",function(t){e.allowed=!1})}},{key:"allowed",value:function(){return u.default.isAuthorized()}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(5)),o=a(n(4));function a(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"getData",value:function(){var e=this.UploadInput.getFormData();return""===e?null:{avatar:e}}},{key:"render",value:function(){return this.UploadInput=new o.default({type:"file",placeholder:"",id:"loadImageInput"}),this.UploadSubmit=new o.default({type:"submit",value:"Save picture",id:"loadImageSubmit"}),this.formElement.appendChild(this.UploadInput.render()),this.formElement.appendChild(this.UploadSubmit.render()),this.formElement.setAttribute("enctype","multipart/form-data"),this.formElement.setAttribute("name","form_loadFile"),this.formElement.classList.add("form-loadFile"),this.formElement}},{key:"setOnSubmit",value:function(e){this.formElement.addEventListener("submit",function(t){t.preventDefault(),e()})}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sectionSwitcher=void 0;var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(28),a=(r=o)&&r.__esModule?r:{default:r};var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"changeSection",value:function(e,t){(0,a.default)(e,t)}}]),e}(),s=new u;t.sectionSwitcher=s,t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(5)),o=u(n(4)),a=u(n(8));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"getData",value:function(){return{oldp:this.OldPassword.getData(),newp:this.Password.getData()}}},{key:"render",value:function(){var e=this;return this.OldPassword=new o.default({type:"password",placeholder:"old password",id:"changeOld"}),this.Password=new o.default({type:"password",placeholder:"new password",id:"changeNew"}),this.RepeatPassword=new o.default({type:"password",placeholder:"repeat password",id:"changeRepeat"}),this.InputSubmit=new o.default({type:"submit",value:"Save",id:"changeSubmit"}),this.OldPassword.setOnInputChange(function(){a.default.checkPass(e.OldPassword)}),this.Password.setOnInputChange(function(){a.default.checkPass(e.Password)}),this.RepeatPassword.setOnInputChange(function(){a.default.checkConfirm(e.Password,e.RepeatPassword)}),this.formElement.appendChild(this.OldPassword.render()),this.formElement.appendChild(this.Password.render()),this.formElement.appendChild(this.RepeatPassword.render()),this.formElement.appendChild(this.InputSubmit.render()),this.formElement}},{key:"setOnSubmit",value:function(e){this.formElement.addEventListener("submit",function(t){t.preventDefault(),e()})}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=f(n(2)),o=f(n(30)),a=f(n(13)),u=f(n(0)),s=f(n(1)),l=f(n(3)),c=f(n(27));function f(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.sign(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"render",value:function(){var e=this;return this.profileElement=document.createElement("div"),this.profileElement.classList.add("div__profile-wrapper"),this.attrs=s.default.getCurUser(),this.profileTable=document.createElement("div"),this.profileTable.innerHTML=generateProfile({user:this.attrs}),this.profileElement.appendChild(this.profileTable),this.profileElement.appendChild(document.createElement("hr")),this.fileForm=new c.default,this.profileElement.appendChild(this.fileForm.render()),this.changeForm=new o.default,this.profileElement.appendChild(this.changeForm.render()),this.backButt=new a.default("button","Back",this.profileElement),this.backButt.setOnClick(function(){(new l.default).open("/")}),this.changeForm.setOnSubmit(function(){var t=e.changeForm.getData(),n=JSON.stringify(t);u.default.emit("user:update",n)}),this.fileForm.setOnSubmit(function(){var e=document.getElementById("loadImageInput"),t=new FormData,n=e.files[0];t.append("image",n),u.default.emit("user:avatarUpload",t)}),this.profileElement}},{key:"allowed",value:function(){return s.default.isAuthorized()}},{key:"sign",value:function(){var e=this;u.default.on("update:error",function(t){e.changeForm.Email.setError(t.payload)})}}]),t}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(5)),o=u(n(4)),a=u(n(8));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"render",value:function(){var e=this;return this.Email=new o.default({type:"text",placeholder:"email",id:"registerEmail"}),this.Name=new o.default({type:"text",placeholder:"name",id:"registerName"}),this.Password=new o.default({type:"password",placeholder:"password",id:"registerPass"}),this.ConfirmPassword=new o.default({type:"password",placeholder:"confirm password",id:"registerPass2"}),this.InputSubmit=new o.default({type:"submit",value:"Sign Up",id:"registerSubmit"}),this.Email.setOnInputChange(function(){a.default.checkMail(e.Email)}),this.Name.setOnInputChange(function(){a.default.checkName(e.Name)}),this.Password.setOnInputChange(function(){a.default.checkPass(e.Password)}),this.ConfirmPassword.setOnInputChange(function(){a.default.checkConfirm(e.Password,e.ConfirmPassword)}),this.formElement.appendChild(this.Email.render()),this.formElement.appendChild(this.Name.render()),this.formElement.appendChild(this.Password.render()),this.formElement.appendChild(this.ConfirmPassword.render()),this.formElement.appendChild(this.InputSubmit.render()),this.formElement}},{key:"getData",value:function(){var e=this.Name.getData(),t=this.Email.getData(),n=this.Password.getData();return""===e||""===t||""===n?null:{username:e,email:t,password:n}}},{key:"setOnSubmit",value:function(e){this.formElement.addEventListener("submit",function(t){t.preventDefault(),e()})}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(2)),o=s(n(32)),a=s(n(0)),u=s(n(1));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return u.default.isAuthorized(),e.sign(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"render",value:function(){var e=this;return this.register=document.createElement("div"),this.register.innerHTML=generateRegister(),this.registerForm=new o.default,this.after=this.register.getElementsByClassName("button")[0],this.register.firstChild.insertBefore(this.registerForm.render(),this.after),this.registerForm.setOnSubmit(function(){var t=e.registerForm.getData();if(console.log(t),null!==t){var n=JSON.stringify(t);a.default.emit("user:signup",n),a.default.on("signup-error",function(t){e.registerForm.Email.setError(t.payload)})}else e.registerForm.Email.setError("Empty fields")}),this.register}},{key:"allowed",value:function(){return!u.default.isAuthorized()}},{key:"sign",value:function(){var e=this;a.default.on("signup-error",function(t){e.registerForm.Email.setError(t.payload)})}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(11),a=(r=o)&&r.__esModule?r:{default:r};var u=function(e){function t(e,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r,i));return o.listeners(),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),i(t,[{key:"listeners",value:function(){}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.aboutRegion=function(e,t){t.innerText="",t.innerText+="name: ",t.innerText+=e.name,t.innerText+=" \n",t.innerText+="region: ",t.innerText+=e.gameData.units}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,n,r){for(var i=n.length,o=i-1,a=!1,u=0;u<i;u++)(r[u]<=t&&t<r[o]||r[o]<=t&&t<r[u])&&e>(n[o]-n[u])*(t-r[u])/(r[o]-r[u])+n[u]&&(a=!a),o=u;return a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(36)),o=c(n(0)),a=c(n(7)),u=n(35),s=c(n(15)),l=n(6);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mode=i,this.canvas=t,this.game_ctx=t.getContext("2d"),this.players=n,this.regions=r,this.about_region=document.getElementById("about-region"),console.log(this.players),this.setPlayersRegions(),i===l.GameModes.multiplayer&&(this.ws=new s.default)}return r(e,[{key:"currentPlayer",value:function(){for(var e=0;e<this.players.length;++e)if(this.players[e].status!==a.default.DISABLED)return this.players[e]}},{key:"nextPlayer",value:function(){for(var e=this.currentPlayer(),t=0;t<this.players.length;++t)if(this.players[t]===e)return t=(t+1)%this.players.length,this.players[t]}},{key:"isRegion",value:function(e,t){for(var n=0;n<this.regions.length;++n)if((0,i.default)(e,t,this.regions[n].area.xp,this.regions[n].area.yp))return this.regions[n];return null}},{key:"isNeighbour",value:function(e,t){for(var n=0;n<e.neighbour.length;n++)if(t.label===e.neighbour[n])return!0;return!1}},{key:"activeRegion",value:function(){for(var e=0;e<this.regions.length;++e)if(!0===this.regions[e].selected)return this.regions[e]}},{key:"deactivatePlayers",value:function(){this.players.forEach(function(e){return e.active=!1})}},{key:"setPlayersRegions",value:function(){for(var e=0;e<this.players.length;e++)this.players[e].addRegion(this.regions[e])}},{key:"onListeners",value:function(){var e=this;this.mode===l.GameModes.singleplayer?(o.default.on("left-click",function(t){var n=e.currentPlayer(),r=t.payload;if(n.status!==a.default.DISABLED){var i=e.isRegion(r.x,r.y);if(i)switch(n.status){case a.default.DEFAULT:if(!n.isTheRegionOfPlayer(i))return;n.status=a.default.READY,(0,u.aboutRegion)(i,e.about_region),o.default.emit("select-region",i);break;case a.default.READY:if(!e.currentPlayer().isTheRegionOfPlayer(i))return;i===e.activeRegion()&&(n.status=a.default.DEFAULT),(0,u.aboutRegion)(i,e.about_region),o.default.emit("change-selection",{active:e.activeRegion(),new:i})}}}),o.default.on("contextmenu",function(t){var n=e.currentPlayer(),r=e.activeRegion(),i=t.payload;if(n.status!==a.default.DISABLED&&n.status===a.default.READY){var s=e.isRegion(i.x,i.y);if(s)if(n.isTheRegionOfPlayer(s))s.gameData.units+=r.gameData.units,r.gameData.units=0,o.default.emit("move-units",{active:e.activeRegion(),new:s}),(0,u.aboutRegion)(s,e.about_region);else{if(!1===e.isNeighbour(r,s))return;o.default.emit("attack",{from:e.activeRegion(),to:s})}}}),o.default.on("left-click-change",function(){var t=e.currentPlayer(),n=e.nextPlayer();t.status!==a.default.DISABLED&&o.default.emit("change-move",{current:t,next:n})}),o.default.on("bot-attack",function(t){for(var n=t.payload,r=0;r<e.regions.length;++r)n.to===e.regions[r].label&&(console.log(n.from.owner,"     ---------"),o.default.emit("attack",{from:n.from,to:e.regions[r]}))}),o.default.on("bot-change-move",function(){o.default.emit("change-move",{current:e.currentPlayer(),next:e.nextPlayer()})}),o.default.on("delete-from-queue",function(t){var n=t.payload;e.players.forEach(function(t,r){t===n&&e.players.splice(r,1)})}),o.default.on("start-game",function(){o.default.emit("illum-cur",e.currentPlayer())})):(o.default.on("left-click",function(t){var n=t.payload,r=e.isRegion(n.x,n.y);if(r&&e.players.isTheRegionOfPlayer(r))switch((0,u.aboutRegion)(r,e.about_region),e.players.status){case a.default.DEFAULT:e.players.status=a.default.READY,o.default.emit("select-region",r);break;case a.default.READY:r===e.activeRegion()&&(e.players.status=a.default.DEFAULT),o.default.emit("change-selection",{active:e.activeRegion(),new:r})}}),o.default.on("contextmenu",function(t){var n=e.activeRegion(),r=t.payload;if(e.players.status!==a.default.DISABLED&&e.players.status===a.default.READY){var i=e.isRegion(r.x,r.y);i&&!1!==e.isNeighbour(n,i)&&(new s.default).send("from-to",{from:e.activeRegion(),to:i})}}),o.default.on("left-click-change",function(){o.default.on("ws-change-move-confirm",function(e){console.log(e),o.default.emit("change-move",{})})}),o.default.on("start-game",function(e){console.log(e)}))}}]),e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=(r=o)&&r.__esModule?r:{default:r};var u=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mode=r,this.game_canvas=t,this.changeBut=n,this.onclick=function(e){console.log(e.offsetX," ",e.offsetY),a.default.emit("left-click",{x:e.offsetX,y:e.offsetY})},this.mousemove=function(e){a.default.emit("mousemove",{x:e.offsetX,y:e.offsetY})},this.contextmenu=function(e){e.preventDefault(),a.default.emit("contextmenu",{x:e.offsetX,y:e.offsetY})},this.clickChangeBut=function(e){a.default.emit("left-click-change",{})}}return i(e,[{key:"start",value:function(){this.game_canvas.addEventListener("click",this.onclick),this.game_canvas.addEventListener("mousemove",this.mousemove),this.game_canvas.addEventListener("contextmenu",this.contextmenu),this.changeBut.addEventListener("click",this.clickChangeBut)}},{key:"stop",value:function(){this.game_canvas.removeEventListener("click",this.onclick),this.game_canvas.removeEventListener("mousemove",this.mousemove),this.game_canvas.removeEventListener("contextmenu",this.contextmenu),this.changeBut.removeEventListener("click",this.clickChangeBut)}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timer=void 0;var r,i=n(0),o=(r=i)&&r.__esModule?r:{default:r};t.timer=function(e){var t=30,n=!1,r=setInterval(function(){n&&++t,e.innerHTML=--t,0===t&&(clearInterval(r),o.default.emit("left-click-change",{}))},1e3);o.default.on("left-click-change",function(){clearInterval(r)}),o.default.on("attack",function(){n=!0,setTimeout(function(){n=!1},1e3)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.battleCalc=function(e,t){return e.gameData.units-2*t.gameData.units>0?(e.gameData.units-=2*t.gameData.units,t.gameData.units=0,!0):(t.gameData.units-=e.gameData.units/2,e.gameData.units=0,!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.moveAnimation=void 0;var r=n(10);t.moveAnimation=function(e,t,n,i){var o=document.getElementsByClassName("wrapper")[0],a=document.createElement("div");a.classList.add("attack-animation"),o.appendChild(a),a.innerHTML=generateAttack({width:.7*window.innerWidth,height:window.innerHeight,id:"attack-canvas"});var u=document.getElementById("attack-canvas").getContext("2d"),s=u.canvas.width,l=window.innerHeight,c=.01*s,f=document.getElementById("game-canvas"),d=window.getComputedStyle(f).marginTop.match(/^[0-9]+/),h=Number(d);t+=h,i+=h;var p=Math.sqrt((e-n)*(e-n)+(t-i)*(t-i)),g=void 0,m=void 0,v=void 0,y=void 0,b=void 0,w=void 0,_=void 0,E=void 0,k=void 0,O=void 0,P=void 0,C=u.createLinearGradient(n,i,e,t),S=u.createLinearGradient(n,i,e,t);(0,r.animate)(function(r){O=r.toFixed(4),P=O/1e3,u.clearRect(0,0,s,l),u.lineWidth=c,C.addColorStop(0,"#030101"),C.addColorStop(.5,"#711615"),C.addColorStop(1,"#ee2357"),S.addColorStop(0,"#030101"),S.addColorStop(.5,"#0d3634"),S.addColorStop(1,"#ee2357"),u.fillStyle=C,u.strokeStyle=S,m=n+(e-n)*P,v=i+(t-i)*P,(g=Math.sqrt((m-n)*(m-n)+(v-i)*(v-i)))<=.76*p&&(E=m,k=v),g>=.75*p&&(y=.2*(t-i)+E,b=.2*(n-e)+k,w=-.2*(t-i)+E,_=-.2*(n-e)+k,u.moveTo(y,b),u.lineTo(y+(e-y)*P,b+(t-b)*P),u.moveTo(w,_),u.lineTo(w+(e-w)*P,_+(t-_)*P)),u.moveTo(n,i),u.lineTo(m,v),u.stroke(),u.fill()},1e3),setTimeout(function(){o.removeChild(o.lastChild)},1e3)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.animationOverlay=void 0;var r=n(10);t.animationOverlay=function(e,t){var n=document.getElementsByClassName("wrapper")[0],i=document.createElement("div");i.classList.add("overlay");var o=document.createElement("canvas");i.appendChild(o),o.setAttribute("id","overlay"),o.width=window.innerWidth,o.height=window.innerHeight,n.appendChild(i);var a=o.getContext("2d"),u=document.getElementById("game-canvas"),s=window.getComputedStyle(u).marginTop.match(/^[0-9]+/),l=Number(s);t+=l;var c=a.canvas.width,f=a.canvas.height,d=void 0,h=a.createLinearGradient(e-.02*c*.66,t-.02*c*.66,e+.02*c*.66,t+.02*c*.66),p=a.createLinearGradient(e-.02*c*.66,t-.02*c*.66,e+.02*c*.66,t+.02*c*.66);(0,r.animate)(function(n){d=(n/1e3*Math.PI*2*10).toFixed(2),a.clearRect(0,0,c,f),a.lineWidth=10,h.addColorStop(0,"#030101"),h.addColorStop(.5,"#711615"),h.addColorStop(1,"#ee2357"),p.addColorStop(0,"#030101"),p.addColorStop(.5,"#0d3634"),p.addColorStop(1,"#ffffff"),a.fillStyle=h,a.strokeStyle=p,a.beginPath(),a.arc(e,t,.02*c,4.72,d/10+4.72,!1),a.stroke()},1e3),setTimeout(function(){n.removeChild(n.lastChild)},1e3)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attackAnimation=void 0;var r=n(10);t.attackAnimation=function(e,t,n,i){var o=document.getElementsByClassName("wrapper")[0],a=document.createElement("div");a.classList.add("attack-animation"),o.appendChild(a),a.innerHTML=generateAttack({width:.7*window.innerWidth,height:window.innerHeight,id:"attack-canvas"});var u=document.getElementById("attack-canvas").getContext("2d"),s=u.canvas.width,l=window.innerHeight,c=document.getElementById("game-canvas"),f=window.getComputedStyle(c).marginTop.match(/^[0-9]+/),d=Number(f);t+=d,i+=d;var h=.03*s,p=.01*s,g=e-h*Math.sin(Math.PI/4);console.log(e,"  ",g);var m=t-h*Math.sin(Math.PI/4);console.log(t,"    ",m);var v=e+h*Math.sin(Math.PI/4),y=t+h*Math.sin(Math.PI/4),b=void 0,w=void 0,_=u.createLinearGradient(g,m,v,y),E=u.createLinearGradient(g,m,v,y);(0,r.animate)(function(r){b=r.toFixed(2),w=b/1e3,u.clearRect(0,0,s,l),u.lineWidth=p,_.addColorStop(0,"#030101"),_.addColorStop(.5,"#711615"),_.addColorStop(1,"#ee2357"),E.addColorStop(0,"#030101"),E.addColorStop(.5,"#0d3634"),E.addColorStop(1,"#ee2357"),u.fillStyle=_,u.strokeStyle=E;var o=2*h*Math.sin(Math.PI/4)+g;b/10+g>=o&&(b=100),u.moveTo(g,m),u.lineTo(b/10+g,b/10+m),u.moveTo(o,m),u.lineTo(o-b/10,b/10+m),u.moveTo(n,i),u.lineTo(n+(e-n)*w,i+(t-i)*w),u.stroke(),u.fill()},1e3),setTimeout(function(){o.removeChild(o.lastChild)},1e3)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=p(n(0)),o=n(43),a=n(42),u=n(41),s=n(17),l=n(40),c=p(n(7)),f=p(n(18)),d=p(n(16)),h=n(39);function p(e){return e&&e.__esModule?e:{default:e}}var g=function(){function e(t,n,r,i,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mode=o,this.controller=t,this.regions=r,this.canvas=n,this.img=i,this.timer=document.getElementById("timer"),this.log=document.getElementById("log")}return r(e,[{key:"start",value:function(){var e=this;(0,h.timer)(this.timer),this.select_region=function(t){var n=t.payload;n.selected=!0,n.area.setStroke("red"),(0,s.renderScene)(e.canvas,e.regions,e.img)},this.change_selection=function(t){var n=t.payload;n.active.selected=!1,n.new.selected=!0;var r=new Promise(function(e,t){e(n.new.area.setStroke("red"))}),i=new Promise(function(e,t){e(n.active.area.setStroke("white"))});r.then(function(){(0,s.renderScene)(e.canvas,e.regions,e.img)}),i.then(function(){(0,s.renderScene)(e.canvas,e.regions,e.img)})},this.attack=function(t){(0,a.animationOverlay)(window.innerWidth/2,.92*e.canvas.height);var n=t.payload,r=n.from,u=n.to;(0,o.attackAnimation)(u.area.xC,u.area.yC,r.area.xC,r.area.yC);var f=(0,l.battleCalc)(r,u);setTimeout(function(){f&&(u.setColor(r.getColor()),u.owner.delRegion(u),0===u.owner.regions.length&&(u.owner.setStatus(c.default.DISABLED),i.default.emit("delete-from-queue",u.owner)),i.default.emit("update-neighbour",{from:r,to:u}),r.owner.addRegion(u),u.area.setStroke("white"),(0,s.renderScene)(e.canvas,e.regions,e.img))},1e3),e.log.innerHTML="<p>Player "+r.name+" attacked "+u.name+"</p>"},this.change_move=function(t){e.regions.forEach(function(e){e.area.setStroke("black")});var n=t.payload;n.current.setStatus(c.default.DISABLED),n.next.setStatus(c.default.DEFAULT),n.next instanceof f.default?(n.next.regions.forEach(function(t){t.area.setStroke("white"),(0,s.renderScene)(e.canvas,e.regions,e.img)}),(0,h.timer)(e.timer),e.controller.start()):n.next instanceof d.default?(n.next.regions.forEach(function(t){t.area.setStroke("white"),(0,s.renderScene)(e.canvas,e.regions,e.img)}),e.controller.stop(),i.default.emit("bot-move",n.next)):e.controller.stop()},this.illum_cur=function(t){t.payload.regions.forEach(function(t){t.area.setStroke("white"),(0,s.renderScene)(e.canvas,e.regions,e.img)})},this.move_units=function(t){var n=t.payload;n.active.selected=!1,n.new.selected=!0,n.new.area.setStroke("red"),(0,s.renderScene)(e.canvas,e.regions,e.img),n.active.area.setStroke("white"),(0,u.moveAnimation)(n.new.area.xC,n.new.area.yC,n.active.area.xC,n.active.area.yC),(0,s.renderScene)(e.canvas,e.regions,e.img)},i.default.on("change-selection",this.change_selection),i.default.on("select-region",this.select_region),i.default.on("change-move",this.change_move),i.default.on("move-units",this.move_units),i.default.on("illum-cur",this.illum_cur),i.default.on("attack",this.attack)}},{key:"destroy",value:function(){i.default.off("change-selection",this.change_selection),i.default.off("select-region",this.select_region),i.default.off("change-move",this.change_move),i.default.off("move-units",this.move_units),i.default.off("illum-cur",this.illum_cur),i.default.off("attack",this.attack)}}]),e}();t.default=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.reachMatrix=[[0,1,1,1,0],[1,0,1,1,1],[1,1,0,0,0],[1,1,0,0,1],[0,1,0,1,0]]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=(r=o)&&r.__esModule?r:{default:r};var u=function(){function e(t,n,r,i,o,u){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.canvas=n,this.game_ctx=this.canvas.getContext("2d"),this.draw(r,i,o),this.xC=r,this.yC=i,this.color=o,this.strokeColor="black",a.default.on("resize-for-draw",function(){for(var e=0;e<u.allowedCoord.length;e++)if(u.allowedCoord[e].name===s.name){s.xC=u.allowedCoord[e].x,s.yC=u.allowedCoord[e].y;break}s.draw()})}return i(e,[{key:"setColor",value:function(e){this.color=e}},{key:"getColor",value:function(){return this.color}},{key:"setStroke",value:function(e){this.strokeColor=e}},{key:"draw",value:function(){this.R=90,this.dR=.866*this.R,this.xp=[this.xC-this.R*this.canvas.width/1e3,this.xC-this.R/2*this.canvas.width/1e3,this.xC+this.R/2*this.canvas.width/1e3,this.xC+this.R*this.canvas.width/1e3,this.xC+this.R/2*this.canvas.width/1e3,this.xC-this.R/2*this.canvas.width/1e3,this.xC-this.R*this.canvas.width/1e3],this.yp=[this.yC,this.yC+this.dR*this.canvas.height/610,this.yC+this.dR*this.canvas.height/610,this.yC,this.yC-this.dR*this.canvas.height/610,this.yC-this.dR*this.canvas.height/610,this.yC],this.game_ctx.beginPath(),this.game_ctx.lineJoin="round",this.game_ctx.lineWidth=4,this.game_ctx.moveTo(this.xp[0],this.yp[0]);for(var e=1;e<this.xp.length;++e)this.game_ctx.lineTo(this.xp[e],this.yp[e]);this.game_ctx.strokeStyle=this.strokeColor,this.game_ctx.stroke(),this.game_ctx.fillStyle=this.color,this.game_ctx.fill(),this.game_ctx.closePath()}},{key:"reColor",value:function(){this.xp=[this.xC-this.R*this.canvas.width/1e3,this.xC-this.R/2*this.canvas.width/1e3,this.xC+this.R/2*this.canvas.width/1e3,this.xC+this.R*this.canvas.width/1e3,this.xC+this.R/2*this.canvas.width/1e3,this.xC-this.R/2*this.canvas.width/1e3,this.xC-this.R*this.canvas.width/1e3],this.yp=[this.yC,this.yC+this.dR*this.canvas.height/610,this.yC+this.dR*this.canvas.height/610,this.yC,this.yC-this.dR*this.canvas.height/610,this.yC-this.dR*this.canvas.height/610,this.yC],this.game_ctx.beginPath(),this.game_ctx.moveTo(this.xp[0],this.yp[0]);for(var e=1;e<this.xp.length;++e)this.game_ctx.lineTo(this.xp[e],this.yp[e]);this.game_ctx.strokeStyle="rgba(255,255,255,0.8)",this.game_ctx.stroke(),this.game_ctx.closePath()}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(46)),o=n(45),a=u(n(0));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t,n,r,i,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.canvas=r,this.game_ctx=this.canvas.getContext("2d"),this.selected=!1,this.allowedCoordinates=i.allowedCoord,this.coordinate=i,this.owner=n,this.color=n.color,this.gameData={units:o},this.setBusListeners(),this.area=null,this.label=null,this.globalRegions=null,this.neighbour=null,this.number=null,this.init()}return r(e,[{key:"setColor",value:function(e){this.area.setColor(e)}},{key:"getColor",value:function(){return this.area.getColor()}},{key:"setGlobalRegions",value:function(e){this.globalRegions=e}},{key:"renderHex",value:function(){this.area.draw()}},{key:"init",value:function(){for(var e=0;e<this.allowedCoordinates.length;++e)if(this.allowedCoordinates[e].allowed)return this.area=new i.default(this.allowedCoordinates[e].name,this.canvas,this.allowedCoordinates[e].x,this.allowedCoordinates[e].y,this.color,this.coordinate),this.number=e,this.neighbour=this.allowedCoordinates[e].neighbour,this.label=this.allowedCoordinates[e].name,void(this.allowedCoordinates[e].allowed=!1)}},{key:"setNeighbours",value:function(e){var t=this;o.reachMatrix[e].forEach(function(e){1===e&&t.neighbour.push(e+1)})}},{key:"setBusListeners",value:function(){var e=this;a.default.on("update-neighbour",function(t){var n=t.payload;n.from.name===e.name?e.removeNeighbour(n.to.name):n.to.name===e.name?(n.from.owner.regions.forEach(function(t){e.removeNeighbour(t.name)}),n.to.owner.regions.forEach(function(e){if(1===o.reachMatrix[n.to.number][e.number]){for(var t=!1,r=0;r<n.to.neighbour.length;++r)n.to.neighbour[r]===e.name&&(t=!0);!1===t&&n.to.neighbour.push(e.name)}})):e.globalRegions.forEach(function(t){if(t.name!==n.to.name||1!==o.reachMatrix[e.number][t.number]);else{for(var r=!1,i=0;i<e.neighbour.length;++i)e.neighbour[i]===n.to.name&&(r=!0);!1===r&&e.neighbour.push(n.to.name)}})}),a.default.on("change-move",function(t){e.gameData.units+=1e3})}},{key:"removeNeighbour",value:function(e){var t=this;this.neighbour.forEach(function(n,r){n===e&&t.neighbour.splice(r,1)}),console.log(this.name,"  ",this.neighbour)}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return Math.floor(Math.random()*(t-e))+e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=c(n(2)),a=c(n(0)),u=c(n(19)),s=c(n(14)),l=n(6);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.parent=document.getElementById("game"),e.wrapper=document.createElement("div"),e.wrapper.classList.add("wrapper"),e.wrapper.innerHTML+=generateCanvas({width:.7*window.innerWidth,height:.525*window.innerWidth*.83,id:"multiplayer-canvas"}),e.parent.appendChild(e.wrapper),e.game_canvas=document.getElementById("multiplayer-canvas"),e.ctx=e.game_canvas.getContext("2d"),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),i(t,[{key:"render",value:function(){var e=this;return this.img=new Image,this.img.src="/map.png",this.load=new Promise(function(t,n){e.img.onload=function(){t(e.ctx.drawImage(e.img,0,0,e.game_canvas.width,e.game_canvas.height))}}),this.load.then(function(){e.setWindowResizeHandler(),e.coordinate=new s.default(e.game_canvas),e.changeBut=e.wrapper.getElementsByClassName("change")[0],e.game=new u.default(l.GameModes.multiplayer,e.game_canvas,e.coordinate,e.changeBut,e.img)}),this.wrapper}},{key:"allowed",value:function(){return!0}},{key:"computeCanvasSize",value:function(){return[.7*window.innerWidth,.525*window.innerWidth*.83]}},{key:"setWindowResizeHandler",value:function(){var e=this;return window.addEventListener("resize",function(){var t=e.computeCanvasSize(),n=r(t,2);e.game_canvas.width=n[0],e.game_canvas.height=n[1],e.ctx.drawImage(e.img,0,0,e.game_canvas.width,e.game_canvas.height),e.coordinate.reSize(e.game_canvas),a.default.emit("resize-for-draw",{})}),this}}]),t}();t.default=f},function(e,t,n){"use strict";var r=d(n(49)),i=d(n(33)),o=d(n(31)),a=d(n(26)),u=d(n(24)),s=d(n(22)),l=d(n(21)),c=d(n(1)),f=d(n(3));function d(e){return e&&e.__esModule?e:{default:e}}var h=document.getElementById("application"),p=document.getElementById("body");c.default.auth().then(function(){new f.default(h,p).add("/",s.default).add("/register",i.default).add("/profile",o.default).add("/rating",a.default).add("/multiplayer",r.default).add("/singleplayer",l.default).add("/login",u.default).start()}).catch()},function(e,t,n){"use strict";var r=document.getElementById("radar"),i=Math.min(document.getElementById("radar-wrapper").offsetHeight,document.getElementById("radar-wrapper").offsetWidth)-100,o=i/2,a=Sketch.create({container:r,fullscreen:!1,width:i,height:i}),u=function(e){return e*(Math.PI/180)},s=270,l=Math.abs(50),c=a.createLinearGradient(o,0,0,0);r.style.marginLeft=r.style.marginTop=-i/2-14+"px",c.addColorStop(0,"hsla( 120, 50%, 40%, 1 )"),c.addColorStop(1,"hsla( 170, 50%, 40%, 0.1 )");a.clear=function(){a.globalCompositeOperation="destination-out",a.fillStyle="hsla( 0, 0%, 0%, 0.1 )",a.fillRect(0,0,i,i)},a.update=function(){s+=1.2},a.draw=function(){a.globalCompositeOperation="lighter",function(){var e;for(e=0;e<4;e++)a.beginPath(),a.arc(o,o,(o-1)/4*(e+1),0,TWO_PI,!1),a.strokeStyle="hsla("+(170-e*(l/4))+", 50%, 40%, 0.1)",a.lineWidth=2,a.stroke()}(),a.beginPath(),a.moveTo(o-1,2),a.lineTo(o-1,i-2),a.moveTo(2,o-1),a.lineTo(i-2,o-1),a.strokeStyle="hsla( 145, 50%, 40%, .03 )",a.stroke(),a.save(),a.translate(o,o),a.rotate(u(s)),a.beginPath(),a.moveTo(0,0),a.arc(0,0,o,u(-2),u(2),!1),a.closePath(),a.fillStyle=c,a.fill(),a.restore(),function(){var e;for(a.beginPath(),e=0;e<i;e+=2)a.moveTo(0,e+.5),a.lineTo(i,e+.5);a.lineWidth=1,a.strokeStyle="hsla( 0, 0%, 0%, .02 )",a.globalCompositeOperation="source-over",a.stroke()}()}},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},function(e,t,n){"use strict";n(79),n(77),n(75),n(73),n(71),n(69),n(67),n(65),n(63),n(61),n(59),n(57),n(55),n(53),n(51),n(50)}]);
//# sourceMappingURL=bundle.js.map
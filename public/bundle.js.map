{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./public/js/modules/bus.js","webpack:///./public/js/modules/userModel.js","webpack:///./public/js/components/views/baseView.js","webpack:///./public/js/modules/router.js","webpack:///./public/js/components/blocks/input/input.js","webpack:///./public/js/components/forms/form.js","webpack:///./public/js/modules/game/config/modes.js","webpack:///./public/js/modules/game/config/playerStates.js","webpack:///./public/js/modules/validator.js","webpack:///./public/js/components/blocks/block.js","webpack:///./public/js/modules/game/animation/animate.js","webpack:///./public/js/modules/game/player/player.js","webpack:///./public/js/conf/route.js","webpack:///./public/js/components/blocks/button.js","webpack:///./public/js/modules/game/config/coordinate.js","webpack:///./public/js/modules/ws.js","webpack:///./public/js/modules/game/player/botPlayer.js","webpack:///./public/js/modules/game/helperFuncs/renderScene.js","webpack:///./public/js/modules/game/player/mainPlayer.js","webpack:///./public/js/modules/game/game.js","webpack:///./public/js/modules/http.js","webpack:///./public/js/components/views/gameView/gameView.js","webpack:///./public/js/components/views/menuView/menuView.js","webpack:///./public/js/components/forms/loginForm.js","webpack:///./public/js/components/views/loginView/loginView.js","webpack:///./public/js/modules/userController.js","webpack:///./public/js/components/views/ratingView/ratingView.js","webpack:///./public/js/components/forms/loadPictureForm/loadPictureForm.js","webpack:///./public/js/components/render/render.js","webpack:///./public/js/modules/sectionSwitcher.js","webpack:///./public/js/components/forms/changeForm.js","webpack:///./public/js/components/views/profileView/profileView.js","webpack:///./public/js/components/forms/registerForm.js","webpack:///./public/js/components/views/registerView/registerView.js","webpack:///./public/js/modules/game/player/webPlayer.js","webpack:///./public/js/modules/game/helperFuncs/renderInfoAboutRegion.js","webpack:///./public/js/modules/game/math/inHex.js","webpack:///./public/js/modules/game/gameScene.js","webpack:///./public/js/modules/game/controller.js","webpack:///./public/js/modules/game/helperFuncs/timer.js","webpack:///./public/js/modules/game/helperFuncs/battleCalc.js","webpack:///./public/js/modules/game/animation/move/moveAnimation.js","webpack:///./public/js/modules/game/animation/animationOverlay.js","webpack:///./public/js/modules/game/animation/attack/attackAnimation.js","webpack:///./public/js/modules/game/gameManager.js","webpack:///./public/js/modules/game/config/reach.js","webpack:///./public/js/modules/graphics/hexagon.js","webpack:///./public/js/modules/game/components/region.js","webpack:///./public/js/modules/game/math/getRandom.js","webpack:///./public/js/components/views/multiplayerView/multiplayerView.js","webpack:///./public/js/application.js","webpack:///./public/js/components/radar/radar.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","Bus","_classCallCheck","this","__instance","listeners","event","listener","_this","push","off","Array","isArray","filter","element","payload","forEach","curUser","User","data","email","username","rating","Promise","resolve","reject","http","route","userAPIMethods","user","err","resp","status","then","promiseValue","userData","post","login","console","log","auth","signup","logout","updateUser","updateAvatar","_userModel","Section","isAuthorized","_sectionSwitcher","Router","root","global","startRoot","document","getElementById","gameRoot","map","active","path","View","view","rootForSwitch","hidden","allowed","window","history","replaceState","open","location","pathname","pushState","sectionSwitcher","changeSection","render","addEventListener","bind","evt","target","tagName","toLowerCase","preventDefault","href","_block","Input","_possibleConstructorReturn","__proto__","getPrototypeOf","wrapper","createElement","CLASS","type","innerHTML","generateInput","placeholder","id","error_id","concat","ErrorElement","getElementsByTagName","InputElement","Block","error","classList","add","style","display","remove","callbackfn","Form","formElement","reset","GameModes","singleplayer","multiplayer","DEFAULT","READY","DISABLED","WON","LOSE","Validator","emailElem","getData","test","setError","nameElem","passElem","length","confElem","animate","draw","duration","start","performance","now","requestAnimationFrame","time","timePassed","_playerStates","_renderScene","Player","color","canvas","img","score","resources","allRegions","regions","PLAYER_STATES","region","newRegion","area","setColor","renderScene","reColor","owner","reg","splice","serverUrl","leaderBoard","Button","parent","buttonWrapper","buttonElement","appendChild","amountofCoorX","amountofCoorY","Coordinate","game_canvas","xSize","width","ySize","height","lengthSide","allowedCoord","x","y","neighbour","_bus","Ws","address","ws","WebSocket","onopen","bus","emit","onmessage","handleMessage","onclose","e","messageText","message","JSON","parse","class","send","stringify","BotPlayer","_this2","on","dict","attackers","attacker","_getRandom2","default","from","to","setTimeout","ctx","getContext","clearRect","drawImage","renderHex","MainPlayer","_modes","Game","mode","coordinate","changeBut","game_ctx","scene","controller","Controller","players","player","arr","Region","setAllRegtions","temp","setGlobalRegions","GameScene","manager","GameManager","initData","getCurUser","indexPlayer","index","botPlayer","obj","units","String","webPlayer","WebPlayer","onListeners","stop","destroy","_route","HttpService","url","request","response","json","body","requestMethod","headers","Headers","append","req","method","credentials","fetch","config","GameSection","generateCanvas","innerWidth","height_canv","innerHeight","marginTop","Image","src","load","onload","setWindowResizeHandler","getElementsByClassName","game","alert","go","_this3","_computeCanvasSize","computeCanvasSize","_computeCanvasSize2","_slicedToArray","reSize","MenuSection","sign","menu","attrsActive","title","attrPassive","generateMenu","attrs","setAttribute","innerText","logoutWrapper","allow","hide","LoginForm","Email","password","Password","InputSubmit","setOnInputChange","checkMail","checkPass","ev","LoginSection","generateLogin","after","loginForm","firstChild","insertBefore","setOnSubmit","jsonUserData","userController","UserController","signUp","catch","signIn","update","avatar","uploadAvatar","page","toString","RatingSection","paginationWrap","prevButt","removeChild","nextButt","empty","lastPage","backButtWrap","backButt","users","table","generateRating","pages","_this4","LoadForm","UploadInput","getFormData","UploadSubmit","child","_render","SectionSwitcher","newSection","rootForElement","_render2","ChangeForm","oldp","OldPassword","newp","RepeatPassword","checkConfirm","ProfileSection","profileElement","profileTable","generateProfile","fileForm","changeForm","setOnClick","file","formData","FormData","upload","files","RegisterForm","Name","ConfirmPassword","checkName","RegisterSection","register","generateRegister","registerForm","_player","aboutRegion","curRegion","domElem","gameData","xp","yp","npol","j","_renderInfoAboutRegion","about_region","setPlayersRegions","curP","currentPlayer","_inHex2","current","label","selected","addRegion","curPlayer","coordinates","isRegion","isTheRegionOfPlayer","activeRegion","new","isNeighbour","nextPlayer","next","regs","cur","onclick","offsetX","offsetY","mousemove","contextmenu","clickChangeBut","removeEventListener","timer","htmlElement","sec","isPaused","g","setInterval","clearInterval","battleCalc","firstRegion","secondRegion","_animate","moveAnimation","x2","y2","wrapAnim","generateAttack","cw","ch","lWidth","result","getComputedStyle","match","mTop","Number","Math","sqrt","curLength","curX","curY","arrowX","arrowY","arrowX2","arrowY2","constX","constY","diff","part","gradient","createLinearGradient","gradientStroke","toFixed","lineWidth","addColorStop","fillStyle","strokeStyle","moveTo","lineTo","stroke","fill","lastChild","animationOverlay","PI","beginPath","arc","attackAnimation","radius","startX","sin","startY","endX","endY","secondX","_attackAnimation","_animationOverlay","_moveAnimation","_battleCalc","_timer","select_region","setStroke","change_selection","setNewColor","setActiveColor","attack","xC","yC","fromWin","getColor","delRegion","setStatus","change_move","illum_cur","move_units","reachMatrix","Hexagon","strokeColor","R","dR","lineJoin","closePath","_reach","allowedCoordinates","setBusListeners","globalRegions","number","init","num","removeNeighbour","f","min","max","floor","random","MultiplayerSection","globalRoot","radar","diameter","offsetHeight","offsetWidth","Sketch","create","container","fullscreen","dToR","degrees","sweepAngle","hueDiff","abs","hueEnd","marginLeft","clear","globalCompositeOperation","fillRect","TWO_PI","renderRings","save","translate","rotate","restore","renderScanLines"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 80);\n","'use strict';\n\n/**\n * Модуль event-bus медиатора\n * @module EventBus\n */\nclass Bus {\n\t/**\n     * @constructor\n     */\n\tconstructor() {\n\t\tif (Bus.__instance) {\n\t\t\treturn Bus.__instance;\n\t\t}\n\t\tthis.listeners = {};\n\t\tBus.__instance = this;\n\t}\n\n\t/**\n     * Зарегистрировать обработчик события\n     * @param {string} event - название события\n     * @param {function} listener - обработчик события\n     * @return {function(this:Bus)} - функция отписки от события\n     */\n\ton(event, listener) {\n\t\tthis.listeners[event] = this.listeners[event] || [];\n\t\tthis.listeners[event].push(listener);\n\t\treturn (() => {\n\t\t\tthis.off(event, listener);\n\t\t});\n\t}\n\n\t/**\n     * Отписаться от события\n     * @param {string} event - название события\n     * @param {function} listener - обработчик события\n     */\n\toff(event, listener) {\n\t\tif (Array.isArray(this.listeners[event])) {\n\t\t\tthis.listeners[event] = this.listeners[event]\n\t\t\t\t.filter((element) => {\n\t\t\t\t\treturn element !== listener;\n\t\t\t\t});\n\t\t}\n\t}\n\n\n\t/**\n     * Заэмиттить событие\n     * @param {string} event - название события\n     * @param {*} [payload] - объект с данными\n     */\n\temit(event, payload) {\n\t\tif (Array.isArray(this.listeners[event])) {\n\t\t\tthis.listeners[event].forEach((listener) => {\n\t\t\t\tlistener({\n\t\t\t\t\tevent: event,\n\t\t\t\t\tpayload: payload,\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport default new Bus();\n","import http from './http.js';\nimport route from '../conf/route.js';\n\n/**\n * Class represents Model of User to store and manage user data\n */\nlet curUser = null;\nexport default class User {\n\t/**\n     * Creates user and loads user data\n     */\n\tconstructor(data) {\n\t\tthis.email = data.email;\n\t\tthis.username = data.username;\n\t\tthis.rating = data.rating;\n\t}\n\n\t/**\n\t * Authenticates user\n\t * @return {Promise<any>}\n\t */\n\tstatic auth() {\n\t\t// if (curUser) {\n\t\t//     resolve(curUser);\n\t\t// }\n\t\treturn new Promise( (resolve, reject) => {\n\t\t\thttp.get(route.userAPIMethods.user, (err, resp) => {\n\t\t\t\tif (err) {\n\t\t\t\t\tif (err.status === 401) {\n\t\t\t\t\t\tcurUser = null;\n\t\t\t\t\t\treturn resolve(null);\n\t\t\t\t\t}\n\t\t\t\t\treturn reject(err);\n\t\t\t\t}\n\t\t\t\tresp.then(\n\t\t\t\t\tpromiseValue => {\n\t\t\t\t\t\tcurUser = new User(promiseValue.data);\n\t\t\t\t\t\tresolve(curUser);\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * If user authorized\n\t * @return {boolean}\n\t */\n\tstatic isAuthorized() {\n\t\treturn !!curUser;\n\t}\n\n\t/**\n\t * Returns current user\n\t * @return {User}\n\t */\n\tstatic getCurUser() {\n\t\treturn curUser;\n\t}\n\n\t/**\n\t * Signs user in\n\t * @param userData\n\t * @return {Promise<any>}\n\t */\n\tstatic signIn(userData) {\n\t\treturn new Promise( (resolve, reject) => {\n\t\t\thttp.post(route.userAPIMethods.login, userData, (err, resp) => {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn reject(err);\n\t\t\t\t}\n\t\t\t\tconsole.log(resp);\n\t\t\t\tresolve(User.auth());\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * signs user Up\n\t * @param userData\n\t * @return {Promise<any>}\n\t */\n\tstatic signUp(userData) {\n\t\treturn new Promise( (resolve, reject) => {\n\t\t\thttp.post(route.userAPIMethods.signup, userData, (err, resp) => {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn reject(err);\n\t\t\t\t}\n\t\t\t\tconsole.log(resp);\n\t\t\t\tresolve(User.auth());\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * logs user Off\n\t * @return {Promise<any>}\n\t */\n\tstatic logout() {\n\t\treturn new Promise( (resolve, reject) => {\n\t\t\thttp.post(route.userAPIMethods.logout, {}, (err, resp) => {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn reject(err);\n\t\t\t\t}\n\t\t\t\tconsole.log(resp);\n\t\t\t\tresolve(User.auth());\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * updates user data\n\t * @param userData\n\t * @return {Promise<any>}\n\t */\n\tstatic update(userData) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\thttp.post(route.userAPIMethods.updateUser, userData, (err, resp) => {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn reject(err);\n\t\t\t\t}\n\t\t\t\tconsole.log(resp);\n\t\t\t\tresolve(User.auth());\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * uploads user's avatar\n\t * @param userData\n\t * @return {Promise<any>}\n\t */\n\tstatic uploadAvatar(userData) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\thttp.post(route.userAPIMethods.updateAvatar, userData, (err, resp) => {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn reject(err);\n\t\t\t\t}\n\t\t\t\tconsole.log(resp);\n\t\t\t});\n\t\t});\n\t}\n}","import User from '../../modules/userModel.js';\n\n/**\n * Class represents generic Section\n */\nexport default class Section {\n\tconstructor() {\n\t\tUser.isAuthorized();\n\t}\n\n\t/**\n     * Should be overriden\n     */\n\trender() {\n\t}\n\n\tallowed() {\n\t\treturn false;\n\t}\n\n\n}\n","import {sectionSwitcher} from './sectionSwitcher.js';\n\n/**\n * Class representing router\n */\nexport default class Router {\n\n\t/**\n\t * Creates router\n\t * @param root\n\t * @param global\n\t * @return {Router|*}\n\t */\n\tconstructor(root, global) {\n\n\t\tif (Router.__instance) {\n\t\t\treturn Router.__instance;\n\t\t}\n\n\t\tthis.root = root;\n\t\tthis.startRoot = document.getElementById('start');\n\t\tthis.gameRoot = document.getElementById('game');\n\t\tthis.map = {};\n\t\tthis.global = global;\n\t\tthis.active = null;\n\n\t\tRouter.__instance = this;\n\t}\n\n\t/**\n\t * adds new page to router\n\t * @param path\n\t * @param View\n\t * @return {Router}\n\t */\n\tadd(path, View) {\n\t\tthis.map[path] = new View(this.root);\n\t\treturn this;\n\t}\n\n\t/**\n\t * opens the page\n\t * @param path\n\t */\n\topen(path) {\n\t\tconsole.log('open');\n\t\tconst view = this.map[path];\n\t\tlet rootForSwitch;\n\t\tif (path === '/singleplayer' || path === '/multiplayer') {\n\t\t\tconsole.log('if');\n\t\t\trootForSwitch =  this.gameRoot;\n\t\t\tthis.startRoot.hidden = true;\n\t\t\trootForSwitch.hidden = false;\n\t\t} else {\n\t\t\tconsole.log('else');\n\t\t\trootForSwitch = this.root;\n\t\t\tthis.startRoot.hidden = false;\n\t\t\tthis.gameRoot.hidden = true;\n\t\t}\n\n\t\tconsole.log('view ', path, 'is allowed: ', view.allowed());\n\t\tif (!view.allowed()) {\n\t\t\twindow.history.replaceState(null, '', '/');\n\t\t\tthis.open('/');\n\t\t\treturn;\n\t\t}\n\t\tif (window.location.pathname !== path) {\n\t\t\twindow.history.pushState(null, '', path);\n\t\t}\n\n\t\t// if (path === '/game') {\n\t\t// \tsectionSwitcher.changeSection(view.render(), this.global);\n\t\t// }\n\t\tsectionSwitcher.changeSection(view.render(), rootForSwitch);\n\t}\n\n\t/**\n\t * Starts the router\n\t */\n\tstart() {\n\t\twindow.addEventListener('popstate', function () {\n\t\t\tthis.open(window.location.pathname);\n\t\t}.bind(this));\n\n\t\tthis.root.addEventListener('click', function (evt) {\n\t\t\tif (evt.target.tagName.toLowerCase() === 'a') {\n\t\t\t\tevt.preventDefault();\n\t\t\t\twindow.history.pushState(null, '', evt.target.href);\n\t\t\t\tthis.open(evt.target.pathname);\n\t\t\t}\n\t\t}.bind(this));\n\t\tconsole.log(window.location.pathname);\n\t\tthis.open(window.location.pathname);\n\t}\n}","/* eslint-disable no-undef */\nimport Block from '../block.js';\n/** Class representing Input */\nexport default class Input extends Block {\n\t/**\n     * Creates input\n     * @param {object} data – contains type, value and placeholder\n     */\n\tconstructor(data) {\n\t\tsuper();\n\n\t\t// this.InputElement = document.createElement('input');\n\t\t// this.InputElement.type = data.type;\n\t\t// if(data.type === 'submit') {\n\t\t// \tthis.InputElement.value = data.value;\n\t\t// \tthis.InputElement.classList.add('button');\n\t\t// }\n\t\t// else {\n\t\t// \tthis.InputElement.placeholder = data.placeholder;\n\t\t// \tthis.InputElement.classList.add('input');\n\t\t// }\n\t\t//\n\t\t// this.InputWrapper = document.createElement('div');\n\t\t// this.InputWrapper.appendChild(this.InputElement);\n\t\t//\n\t\tthis.status = true; //заглушка\n\t\t//\n\t\t// this.ErrorElement = document.createElement('div');\n\t\t// this.ErrorElement.classList.add('error');\n\t\t// this.lamp = document.createElement('div');\n\t\t// this.lamp.innerHTML = generateLamp();\n\t\t// this.InputWrapper.appendChild(this.lamp);\n\t\t// this.InputWrapper.appendChild(this.ErrorElement);\n\t\t//\n\t\t//\n\t\tthis.wrapper = document.createElement('div');\n\t\t//TODO здесь надо указать все типы инпутов, которым не нужна лампа\n\n\t\tlet CLASS = 'input';\n\t\tif (data.type === 'submit') {\n\t\t\tCLASS = 'button';\n\t\t}\n\t\tthis.wrapper.innerHTML += generateInput({\n\t\t\ttype: data.type,\n\t\t\tplaceholder: data.placeholder,\n\t\t\tvalue: data.value,\n\t\t\tid: data.id,\n\t\t\terror_id: data.id.concat('_error'),\n\t\t\tCLASS: CLASS\n\t\t});\n\t\tthis.ErrorElement = this.wrapper.getElementsByTagName('div')[0];\n\t\tthis.InputElement = this.wrapper.getElementsByTagName('input')[0];\n\t}\n\n\t/**\n     * Returns input DOM element\n     * @return {HTMLDivElement | *}\n     */\n\trender() {\n\t\treturn this.wrapper;\n\t}\n\n\t/**\n     * For validation process\n     * @return {boolean} – true if valid\n     */\n\tgetState() {\n\t\treturn this.status;\n\t}\n\n\t/**\n     * Returns input data\n     * @return {string}\n     */\n\tgetData() {\n\t\treturn this.InputElement.value;\n\t}\n\tgetFormData() {\n\t\treturn this.InputElement;\n\t}\n\n\t/**\n     * To set error message or unset error\n     * @param {string} error\n     */\n\tsetError(error) {\n\t\tif (error) {\n\t\t\tthis.status = false;\n\t\t\tthis.ErrorElement.innerHTML = error;\n\t\t\tthis.InputElement.classList.add('input__error');\n\t\t} else {\n\t\t\tthis.status = true;\n\t\t\tthis.ErrorElement.style.display = 'none';\n\t\t\tthis.InputElement.classList.remove('input__error');\n\t\t}\n\t}\n\n\n\t//TODO: в качестве коллбека можешь передать методы валидатора, тогда ему будут видны поля этого класса\n\t/**\n     * Defines behaviour on change\n     * @param {function} callbackfn – input data change handler\n     */\n\tsetOnInputChange(callbackfn) {\n\t\tthis.InputElement.addEventListener('change', (event) => {\n\t\t\tevent.preventDefault();\n\t\t\tcallbackfn();\n\t\t});\n\t}\n}","import Block from '../blocks/block.js';\n\n/** Class representing generic form */\nexport default class Form extends Block {\n\t/**\n     * Create a form\n     */\n\tconstructor() {\n\t\tsuper();\n\t\tthis.formElement = document.createElement('form');\n\t}\n\n\t/**\n     * should be overriden\n     */\n\trender() {\n\n\t}\n\n\t/**\n     * to reset form data\n     */\n\treset() {\n\t\tthis.formElement.reset();\n\t}\n\n\t/**\n     * should be overriden\n     */\n\tsetOnSubmit() {\n\t}\n\n\t//TODO после сабмита пробежишься по всем инпутам и проверяешь их стейты\n\t//TODO если что-то не так, то тогда от компоненты вызываешь setError, который должен разхидить errorElement\n}","export const GameModes = {\n\tsingleplayer: 1,\n\tmultiplayer: 2\n};","/**\n * for player management\n * @type {{DEFAULT: number, READY: number, DISABLED: number, WON: number, LOSE: number}}\n */\nconst PLAYER_STATES = {\n\tDEFAULT : 1,\n\tREADY : 2,\n\tDISABLED : 3,\n\tWON : 4,\n\tLOSE: 5\n};\nexport default PLAYER_STATES;","/**\n * Class represents set of tools to validate forms\n */\nexport default class Validator {\n\n\t/**\n     * Validation of Email input\n     * @param emailElem\n     */\n\tstatic checkMail(emailElem) {\n\n\t\tconst email = emailElem.getData();\n\t\tconst pattern = /([\\w-]+)@([\\w-]+)(\\.[\\w]+)/;\n\t\tif (pattern.test(email) === false) {\n\t\t\temailElem.setError('incorrect email');\n\t\t} else {\n\t\t\temailElem.setError(null);\n\t\t}\n\t}\n\n\t/**\n     * Validation of Name input\n     * @param nameElem\n     */\n\tstatic checkName(nameElem) {\n\t\tconst name = nameElem.getData();\n\t\tconst pattern = /^[a-zA-Z0-9_-]{3,16}$/;\n\t\tif (pattern.test(name)) {\n\t\t\tnameElem.setError(null);\n\t\t} else {\n\t\t\tnameElem.setError('incorrect name');\n\t\t}\n\t}\n\n\t/**\n     * Validation of Password input\n     * @param passElem\n     */\n\tstatic checkPass(passElem) {\n\t\tconst pass = passElem.getData();\n\t\tif (pass.length < 8) {\n\t\t\tpassElem.setError('too short password');\n\t\t} else {\n\t\t\tpassElem.setError(null);\n\t\t}\n\t}\n\n\t/**\n     * Validation of PasswordConfirm input\n     * @param passElem\n     * @param confElem\n     */\n\tstatic checkConfirm(passElem, confElem) {\n\t\tif (passElem.getData() !== confElem.getData()) {\n\t\t\tconfElem.setError('passwords do not match');\n\t\t} else {\n\t\t\tconfElem.setError(null);\n\t\t}\n\t}\n}","export default class Block {\n/**\n* should be overriden\n*/\n\trender() {}\n}","export const animate = (draw, duration) => {\n\tconst start = performance.now();\n\trequestAnimationFrame(function animate(time) {\n\t\tlet timePassed = time - start;\n\t\tif (timePassed > duration) timePassed = duration;\n\t\tdraw(timePassed);\n\t\tif (timePassed < duration) {\n\t\t\trequestAnimationFrame(animate);\n\t\t}\n\t});\n};","import PLAYER_STATES from '../config/playerStates.js';\nimport {renderScene} from '../helperFuncs/renderScene.js';\n\n/**\n * Class representing generic game Player\n */\nexport default class Player {\n\t/**\n\t * Creates player\n\t * @param name\n\t * @param color\n\t */\n\tconstructor(name, color, canvas,  img) {\n\t\tthis.score = 0;\n\t\tthis.resources = 0;\n\t\tthis.canvas = canvas;\n\t\tthis.allRegions = null;\n\t\tthis.img = img;\n\t\tthis.regions = [];\n\t\tthis.status = PLAYER_STATES.DISABLED;\n\t\tthis.color = color;\n\t\tthis.name = name;\n\t}\n\n\tsetAllRegtions(regions) {\n\t\tthis.allRegions = regions;\n\t}\n\n\t/**\n\t * should be overriden\n\t */\n\tinit() {\n\n\t}\n\n\t/**\n\t * Принадлежит ли данный регион игроку\n\t * @param region\n\t * @return {boolean}\n\t */\n\tisTheRegionOfPlayer(region) {\n\t\tfor (let i = 0; i < this.regions.length; ++i) {\n\t\t\tif (this.regions[i].name === region.name) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Gives the player new region\n\t * @param newRegion\n\t */\n\taddRegion(newRegion) {\n\t\tnewRegion.area.setColor(this.color);\n\t\trenderScene(this.canvas, this.allRegions, this.img);\n\t\tnewRegion.area.reColor(this.color);\n\t\tnewRegion.owner = this;\n\t\tthis.regions.push(newRegion);\n\t}\n\n\t/**\n\t * deletes region\n\t * @param reg\n\t */\n\tdelRegion(reg) {\n\t\tfor (let i = 0; i < this.regions.length; ++i) {\n\t\t\tif (this.regions[i] === reg) {\n\t\t\t\tthis.regions.splice(i,1);\n\t\t\t}\n\t\t}\n\t\tif (this.regions.length === 0) {\n\t\t\tthis.status = PLAYER_STATES.LOSE;\n\t\t}\n\t}\n\n\t/**\n\t * sets player's status\n\t * @param status\n\t */\n\tsetStatus(status) {\n\t\tthis.status = status;\n\t}\n}","\nconst serverUrl = 'https://rha-backend.herokuapp.com/';\n//const serverUrl = 'http://localhost:5000/';\n\n/**\n * Contains methods' paths of user API\n * @type {{login: string, signup: string, logout: string, user: string, updateUser: string, leaderBoard: string}}\n */\nconst userAPIMethods = {\n\tlogin: 'users/auth',\n\tsignup: 'users/create',\n\tlogout: 'users/logout',\n\tuser: 'users/info',\n\tupdateUser: 'users/chpwd',\n\tleaderBoard: 'users/rating',\n\tupdateAvatar: 'users/chava'\n};\n\n// export const route = {\n//     debug: true\n// };\n\nexport default {serverUrl, userAPIMethods};","import Block from './block.js';\n/** Class representing button */\nexport default class Button extends Block {\n    /**\n    * Create a button\n    * @param {string} type   - type of the button\n    * @param {string} value  - inner text\n    * @param {string} parent - parent element\n    */\n\tconstructor(type, value, parent) {\n\t\tsuper();\n\t\tthis.buttonWrapper = document.createElement('div');\n\t\tthis.buttonElement = document.createElement('button');\n\t\tthis.buttonElement.classList.add('btn-style');\n\t\tthis.buttonElement.classList.add('button');\n\t\tthis.buttonElement.innerHTML = value;\n\t\tthis.buttonElement.type = type;\n\n\t\tif (parent) {\n\t\t\tparent.appendChild(this.buttonWrapper);\n\t\t}\n\t\tthis.buttonWrapper.classList.add('page-button');\n\n\t\tthis.buttonWrapper.appendChild(this.buttonElement);\n\t}\n\n\t/**\n     * Get the button DOM element\n     * @return {HTMLDivElement | *}\n     */\n\trender() {\n\t\treturn this.buttonWrapper;\n\t}\n\n\t/**\n     * To make a button hidden\n     */\n\thide() {\n\t\tthis.buttonWrapper.classList.add('hidden');\n\t}\n\n\t/**\n     * To make button visible\n     */\n\tshow() {\n\t\tthis.buttonWrapper.classList.remove('hidden');\n\t}\n\n\t/**\n     * Defines behaviour on click\n     * @param {function} callbackfn - button click handler\n     */\n\tsetOnClick(callbackfn) {\n\t\tthis.buttonElement.addEventListener('click',  event => {\n\t\t\tevent.preventDefault();\n\t\t\tcallbackfn();\n\t\t});\n\t}\n}\n","\n\n\nconst amountofCoorX = 1000;\nconst amountofCoorY = 610;\n\nexport default class Coordinate {\n\tconstructor(game_canvas) {\n\t\tif (Coordinate.__instance) {\n\t\t\treturn Coordinate.__instance;\n\t\t}\n\t\tCoordinate.__instance = this;\n\t\tthis.game_canvas = game_canvas;\n\t\tthis.xSize = game_canvas.width / amountofCoorX;\n\t\tthis.ySize = game_canvas.height / amountofCoorY;\n\n\n\t\tthis.lengthSide = 90;\n\n\t\tthis.allowedCoord = [\n\t\t\t{\n\t\t\t\tname: 'A',\n\t\t\t\tx: this.xSize * 365,\n\t\t\t\ty: 345 * this.ySize,\n\t\t\t\tallowed: true,\n\t\t\t\tneighbour: ['B', 'C', 'D']\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'B',\n\n\t\t\t\tx: (325 + this.lengthSide * 2) * this.xSize,\n\t\t\t\ty: (339 - this.lengthSide * 0.86) * this.ySize,\n\n\t\t\t\tallowed: true,\n\t\t\t\tneighbour: ['A', 'C', 'D', 'E']\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'C',\n\t\t\t\tx: 365 * this.xSize,\n\t\t\t\ty: (339 - this.lengthSide * 0.86 * 2) * this.ySize,\n\t\t\t\tallowed: true,\n\t\t\t\tneighbour: ['A', 'B']\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'D',\n\t\t\t\tx: (325 + this.lengthSide * 2) * this.xSize,\n\t\t\t\ty: (345 + this.lengthSide * 0.86) * this.ySize,\n\t\t\t\tallowed: true,\n\t\t\t\tneighbour: ['A', 'B', 'E']\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'E',\n\t\t\t\tx: ((329 + this.lengthSide * 2) + 136) * this.xSize,\n\t\t\t\ty: 343 * this.ySize,\n\t\t\t\tallowed: true,\n\t\t\t\tneighbour: ['B', 'D']\n\t\t\t}\n\t\t];\n\t}\n\n\treSize(game_canvas) {\n\t\tthis.xSize = game_canvas.width / amountofCoorX;\n\t\tthis.ySize = game_canvas.height / amountofCoorY;\n\n\t\t//TODO сделать по-человечески\n\t\tthis.allowedCoord = [\n\t\t\t{\n\t\t\t\tname: 'A',\n\t\t\t\tx: this.xSize * 365,\n\t\t\t\ty: 345 * this.ySize,\n\t\t\t\tallowed: true,\n\t\t\t\tneighbour: ['B', 'C', 'D']\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'B',\n\t\t\t\tx: (321 + this.lengthSide * 2) * this.xSize,\n\t\t\t\ty: (345 - this.lengthSide * 0.86) * this.ySize,\n\t\t\t\tallowed: true,\n\t\t\t\tneighbour: ['A', 'C', 'D', 'E']\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'C',\n\t\t\t\tx: 365 * this.xSize,\n\t\t\t\ty: (345 - this.lengthSide * 0.86 * 2) * this.ySize,\n\t\t\t\tallowed: true,\n\t\t\t\tneighbour: ['A', 'B']\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'D',\n\t\t\t\tx: (321 + this.lengthSide * 2) * this.xSize,\n\t\t\t\ty: (345 + this.lengthSide * 0.86) * this.ySize,\n\t\t\t\tallowed: true,\n\t\t\t\tneighbour: ['A', 'B', 'E']\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'E',\n\t\t\t\tx: ((321 + this.lengthSide * 2) + 136) * this.xSize,\n\t\t\t\ty: 345 * this.ySize,\n\t\t\t\tallowed: true,\n\t\t\t\tneighbour: ['B', 'D']\n\t\t\t}\n\t\t];\n\n\t}\n}","import bus from './bus.js';\n\nexport default class Ws {\n\n\tconstructor() {\n\t\tif (Ws.__instance) {\n\t\t\treturn Ws.__instance;\n\t\t}\n\t\tconst address = 'wss://rha-backend.herokuapp.com/multiplayer/rand';\n\t\tthis.ws = new WebSocket(address);\n\t\tthis.ws.onopen = (event) => {\n\t\t\tconsole.log(`WebSocket on address ${address} opened`);\n\t\t\tbus.emit('connected', {});\n\t\t\tthis.ws.onmessage = this.handleMessage.bind(this);\n\n\t\t\tthis.ws.onclose = (e) => {\n\t\t\t\tconsole.log(e);\n\t\t\t\tconsole.log('WebSocket closed');\n\t\t\t};\n\t\t};\n\t\tWs.__instance = this;\n\t}\n\n\thandleMessage(event) {\n\t\tconst messageText = event.data;\n\t\tconsole.log('got message ', messageText);\n\t\ttry {\n\t\t\tconst message = JSON.parse(messageText);\n\t\t\tbus.emit(message.class, message);\n\t\t} catch (err) {\n\t\t\tconsole.error('smth went wront in handleMessage: ', err);\n\t\t}\n\t}\n\n\tsend(type, payload) {\n\t\tconsole.log('sent message: type - ', type, ' data - ', payload);\n\t\tthis.ws.send(JSON.stringify({\n\t\t\tclass: type,\n\t\t\tpayload: payload\n\t\t}));\n\t}\n}\n\n","/* eslint-disable indent */\nimport Player from './player.js';\nimport bus from '../../bus.js';\nimport getRandom from '../math/getRandom.js';\n\n/**\n * Class representing game Player\n */\nexport default class BotPlayer extends Player {\n\t/**\n\t * Creates Player\n\t * @param name\n\t * @param color\n\t */\n\tconstructor(name, color, canvas,  img) {\n\t\tsuper(name, color, canvas,  img);\n\n\t\tthis.listeners();\n\t}\n\n\t/**\n\t * Sets up player's listeners\n\t */\n\tlisteners() {\n\t\tbus.on('bot-move', dict => {\n\t\t\tconst nextPLayer = dict.payload;\n\t\t\tif (nextPLayer.name !== this.name) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// debugger;\n\t\t\tconst attackers = [];\n\t\t\tfor (let i = 0; i < this.regions.length; i++) {\n\n\t\t\t\tif (this.regions[i].neighbour.length === 0) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tattackers.push(this.regions[i]);\n\t\t\t}\n\t\t\tconst attacker = getRandom(0, attackers.length - 1);\n\t\t\t// debugger;\n\t\t\tbus.emit('bot-attack', {\n\t\t\t\tfrom: attackers[attacker],\n\t\t\t\tto: attackers[attacker].neighbour[getRandom(0, attackers[attacker].neighbour.length - 1)]\n\t\t\t});\n\t\t\tsetTimeout(() => {\n\t\t\t\tbus.emit('bot-change-move', 'bot');\n\t\t\t}, 1000);\n\t\t});\n\t}\n}","\n\nexport  const renderScene = (canvas, regions, img) => {\n\tconst ctx = canvas.getContext('2d');\n\tctx.clearRect(0, 0, canvas.width, canvas.height);\n\tctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n\tregions.forEach((region) => {\n\t\tregion.renderHex();\n\t});\n};","import Player from './player.js';\nimport PLAYER_STATES from '../config/playerStates.js';\nimport bus from '../../bus.js';\n\n/**\n * Class representing client's player\n */\nexport default class MainPlayer extends Player {\n\t/**\n\t * Creates main player\n\t * @param name\n\t * @param color\n\t */\n\tconstructor(name, color, canvas,  img) {\n\t\tsuper(name, color, canvas, img);\n\t\tthis.status = PLAYER_STATES.DEFAULT;\n\t}\n\n\tdelRegion(reg) {\n\t\tfor (let i = 0; i < this.regions.length; ++i) {\n\t\t\tif (this.regions[i] === reg) {\n\t\t\t\tthis.regions.splice(i,1);\n\t\t\t}\n\t\t}\n\t\tif (this.regions.length === 0) {\n\t\t\tthis.status = PLAYER_STATES.LOSE;\n\t\t\tbus.emit('gameover', {});\n\t\t}\n\t}\n}","import MainPlayer from './player/mainPlayer.js';\nimport BotPlayer from './player/botPlayer.js';\nimport Region from './components/region.js';\nimport GameManager from './gameManager.js';\nimport Controller from './controller.js';\nimport GameScene from './gameScene.js';\nimport bus from '../bus.js';\nimport {GameModes} from './config/modes.js';\nimport Ws from '../ws.js';\nimport User from '../userModel.js';\nimport WebPlayer from './player/webPlayer.js';\n\n/**\n * Class representing game\n */\nexport default class Game {\n\t/**\n\t * Creates game\n\t * @param mode\n\t * @param game_canvas\n\t * @param change_canvas\n\t */\n\tconstructor(mode, game_canvas, coordinate, changeBut, img) {\n\t\t//let GameConstructor = null;\n\n\t\t// if (Game.__instance) {\n\t\t// \treturn Game.__instance;\n\t\t// }\n\t\tthis.listeners = {};\n\t\tGame.__instance = this;\n\n\t\tthis.mode = mode;\n\t\tthis.game_canvas = game_canvas;\n\t\tthis.coordinate = coordinate;\n\t\tthis.game_ctx = this.game_canvas.getContext('2d');\n\t\tthis.img = img;\n\t\tthis.scene = null;\n\t\tthis.controller = new Controller(this.game_canvas, changeBut, this.mode);\n\t\tconsole.log(this.mode);\n\t\tif (this.mode === GameModes.singleplayer) {\n\t\t\tthis.players = [\n\t\t\t\tnew MainPlayer('A', 'rgba(0,255,127,0.4)', this.game_canvas, this.img),\n\t\t\t\tnew BotPlayer('B','rgba(0,0,205,0.4)', this.game_canvas, this.img),\n\t\t\t\tnew BotPlayer('C', 'rgba(255,69,0,0.4)', this.game_canvas, this.img),\n\t\t\t\tnew BotPlayer('D', 'rgba(139,125,107,0.4)', this.game_canvas, this.img),\n\t\t\t\tnew BotPlayer('E', 'rgba(255,165,0,0.4)', this.game_canvas, this.img)\n\t\t\t];\n\t\t\tthis.regions = [];\n\n\t\t\tthis.players.forEach( (player, i, arr) => {\n\t\t\t\tthis.regions.push(new Region(player.name, player,\n\t\t\t\t\tthis.game_canvas, this.coordinate, (arr.length - i) * 1000));\n\t\t\t});\n\t\t\tthis.players.forEach(player => {\n\t\t\t\tplayer.setAllRegtions(this.regions);\n\t\t\t});\n\t\t\tthis.regions.forEach(temp => {\n\t\t\t\ttemp.setGlobalRegions(this.regions);\n\t\t\t});\n\n\t\t\tthis.scene = new GameScene(this.game_canvas, this.players, this.regions, this.mode);\n\n\t\t\tthis.manager = new GameManager(this.controller, this.game_canvas, this.regions, this.img, this.mode);\n\t\t} else {\n\t\t\tthis.Ws = new Ws();\n\t\t\tbus.on('connected', () => {\n\t\t\t\tthis.Ws.send('JoinGame$Request', {});\n\t\t\t\tbus.on('InitGame$Request', (data) => {\n\t\t\t\t\t//TODO установить игроков\n\t\t\t\t\tconst initData = data.payload;\n\t\t\t\t\tconst username = User.getCurUser().username;\n\t\t\t\t\tlet indexPlayer;\n\t\t\t\t\tinitData.players.forEach((player, index) => {\n\t\t\t\t\t\tif (player === username) {\n\t\t\t\t\t\t\tindexPlayer = index + 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthis.players = [];\n\t\t\t\t\tthis.regions = [];\n\t\t\t\t\tthis.botPlayer = new BotPlayer('bot', 'rgba(0,0,205,0.4)', this.game_canvas, this.img);\n\t\t\t\t\tinitData.map.forEach((obj,i) => {\n\t\t\t\t\t\tif (obj.owner === indexPlayer) {\n\t\t\t\t\t\t\tconst player = new MainPlayer(username, 'rgba(0,255,127,0.4)', this.game_canvas, this.img);\n\t\t\t\t\t\t\tthis.players.push(player);\n\t\t\t\t\t\t\tconst region = new Region(username, player, this.game_canvas, this.coordinate, obj.units);\n\t\t\t\t\t\t\tthis.regions.push(region);\n\t\t\t\t\t\t\t// player.addRegion(region);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (obj.owner === 0) {\n\t\t\t\t\t\t\tconst region = new Region(String(i), this.botPlayer, this.game_canvas, this.coordinate, 0);\n\t\t\t\t\t\t\tthis.regions.push(region);\n\t\t\t\t\t\t\t// this.botPlayer.addRegion(region);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tinitData.players.forEach((player, i) => {\n\t\t\t\t\t\t\t\tif (obj.owner === i + 1) {\n\t\t\t\t\t\t\t\t\tconsole.log('in else');\n\t\t\t\t\t\t\t\t\tthis.webPlayer = new WebPlayer(player, 'rgba(255,69,0,0.4)', this.game_canvas, this.img);\n\t\t\t\t\t\t\t\t\tthis.players.push(this.webPlayer);\n\t\t\t\t\t\t\t\t\tconst region = new Region(player, this.webPlayer, this.game_canvas, this.coordinate, obj.units);\n\t\t\t\t\t\t\t\t\tthis.regions.push(region);\n\t\t\t\t\t\t\t\t\t// this.webPlayer.addRegion(region);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.players.forEach(player => {\n\t\t\t\t\t\tplayer.setAllRegtions(this.regions);\n\t\t\t\t\t});\n\n\t\t\t\t\tconsole.log(username);\n\t\t\t\t\tconsole.log(initData);\n\n\t\t\t\t\tthis.scene = new GameScene(this.game_canvas, this.players, this.regions, this.mode);\n\t\t\t\t\tthis.manager = new GameManager(this.controller, this.game_canvas, this.regions, this.img, this.mode);\n\t\t\t\t\tthis.start();\n\t\t\t\t\t// Ws.send('set-players-confirm', true);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Starts game\n\t */\n\tstart() {\n\t\tthis.controller.start();\n\t\tthis.scene.onListeners();\n\t\tthis.manager.start();\n\t\tbus.emit('start-game', {});\n\t}\n\n\t/**\n\t * turns game off\n\t */\n\tdestroy() {\n\t\tthis.controller.stop();\n\t\tthis.manager.destroy();\n\t}\n\n}\n\n//todo ИНТЕРФЕЙС БЛ*ТЬ\n\n/*\n* JoinGame$Request\n* InitGame$Request\n* ClientTurn$Request\n* lovim\n* InitGame$Request\n* FinishGame\n* ServerTurn\n */\n","import config from '../conf/route.js';\n\n/**\n * Class represents interface for working with HTTP\n */\nclass HttpService {\n\t/**\n     * GET request\n     * @param url\n     * @param  {function} callbackfn\n     * @return {PromiseLike<T> | Promise<T>}\n     */\n\tstatic get(url, callbackfn) {\n\t\treturn this.request('GET', url)\n\t\t\t.then (\n\t\t\t\tresponse => {\n\t\t\t\t\tif (response.status === 200) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcallbackfn(null, response.json());\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcatch (err) {\n\t\t\t\t\t\t\tconsole.error('get error: ', err);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcallbackfn(response, null);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t}\n\n\t/**\n     * POST request\n     * @param url\n     * @param body\n     * @param  {function} callbackfn\n     * @return {PromiseLike<T> | Promise<T>}\n     */\n\tstatic post(url, body, callbackfn) {\n\t\treturn this.request('POST', url, body)\n\t\t\t.then (\n\t\t\t\tresponse => {\n\t\t\t\t\tif (response.status < 300) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcallbackfn(null, response.json());\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcatch (err) {\n\t\t\t\t\t\t\tconsole.error('post error: ', err);\n\t\t\t\t\t\t\tcallbackfn(err);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcallbackfn(response);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t);\n\t}\n\n\t/**\n     * Generic request\n     * @param requestMethod\n     * @param url\n     * @param body\n     * @return {Promise<Response>}\n     */\n\tstatic request(requestMethod, url, body) {\n\t\tconst headers = new Headers();\n\n\t\tif (requestMethod ==='POST') {\n\t\t\tif (url !== 'users/chava') {\n\t\t\t\theaders.append('Content-Type', 'application/json; charset=utf-8');\n\t\t\t}\n\n\t\t}\n\n\t\tconst req = {\n\t\t\tmethod: requestMethod,\n\t\t\theaders: headers,\n\t\t\tbody: body,\n\t\t\tcredentials: 'include',\n\t\t\tmode: 'cors'\n\t\t};\n\t\t//TODO:: на время\n\t\t// if (url === 'users/chava') {\n\t\t// \treturn fetch('http://localhost:5000/users/chava', req);\n\t\t// }\n\t\treturn fetch(`${config.serverUrl}${url}`, req);\n\t}\n}\n\nexport default HttpService;","/* eslint-disable no-undef */\nimport Section from '../baseView.js';\nimport Game from '../../../modules/game/game.js';\nimport bus from '../../../modules/bus.js';\nimport Coordinate from '../../../modules/game/config/coordinate.js';\nimport {GameModes} from '../../../modules/game/config/modes.js';\n\n\n/**\n * Class representing Section of the game\n */\nexport default class GameSection extends Section {\n\t/**\n\t * Creates game section\n\t */\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.parent = document.getElementById('game');\n\t\tthis.wrapper = document.createElement('div');\n\t\tthis.wrapper.classList.add('wrapper');\n\n\t\tthis.wrapper.innerHTML += generateCanvas(\n\t\t\t{\n\t\t\t\t'width': window.innerWidth * 0.7,\n\t\t\t\t'height': window.innerWidth * 0.525 * 0.83,\n\t\t\t\t'id': 'game-canvas'\n\t\t\t}\n\t\t);\n\t\tthis.height_canv = window.innerHeight * 0.83;\n\t\tthis.parent.appendChild(this.wrapper);\n\t\tthis.game_canvas = document.getElementById('game-canvas');\n\t\tthis.ctx = this.game_canvas.getContext('2d');\n\n\t\tthis.game_canvas.style.marginTop = String(100 - 100 * this.game_canvas.height / this.height_canv) / 2 + '%';\n\n\t}\n\t/**\n\t * @return {HTMLDivElement | *}\n\t */\n\trender() {\n\n\t\tthis.img = new Image();\n\t\tthis.img.src = '/map.png';\n\t\tthis.load = new Promise(resolve => {\n\t\t\tthis.img.onload = () => {\n\t\t\t\tresolve(this.ctx.drawImage(this.img, 0,0, this.game_canvas.width, this.game_canvas.height));\n\t\t\t};\n\t\t});\n\t\tthis.load\n\t\t\t.then(\n\t\t\t\t() => {\n\t\t\t\t\tthis.setWindowResizeHandler();\n\t\t\t\t\tthis.coordinate = new Coordinate(this.game_canvas);\n\t\t\t\t\tthis.changeBut = this.wrapper.getElementsByClassName('change')[0];\n\t\t\t\t\tthis.game = new Game(GameModes.singleplayer, this.game_canvas, this.coordinate, this.changeBut, this.img);\n\t\t\t\t\tthis.game.start();\n\t\t\t\t}\n\t\t\t);\n\n\t\tbus.on('gameover', () => {\n\t\t\talert('gameover');\n\t\t\tthis.game.destroy();\n\t\t\thistory.go('/singleplayer');\n\t\t});\n\t\treturn this.wrapper;\n\t}\n\n\n\t/**\n\t * @return {boolean}\n\t */\n\tallowed() {\n\t\t// return User.isAuthorized();\n\t\treturn true;\n\t}\n\n\tcomputeCanvasSize() {\n\t\t// const size = (window.innerWidth > window.innerHeight) ? window.innerHeight : window.innerWidth;\n\t\treturn [window.innerWidth * 0.7, window.innerWidth * 0.525 * 0.83];\n\t}\n\n\tsetWindowResizeHandler() {\n\t\twindow.addEventListener('resize', () => {\n\t\t\tlet beforeResize = {\n\t\t\t\twidth: this.game_canvas.width,\n\t\t\t\theight: this.game_canvas.height\n\t\t\t};\n\t\t\t[this.game_canvas.width, this.game_canvas.height] = this.computeCanvasSize();\n\t\t\tthis.ctx.drawImage(this.img, 0, 0, this.game_canvas.width, this.game_canvas.height);\n\t\t\tthis.coordinate.reSize(this.game_canvas);\n\n\t\t\tthis.game_canvas.style.marginTop = String(100 - 100 * this.game_canvas.height / this.height_canv) / 2 + '%';\n\n\t\t\tbus.emit('resize-for-draw', {});\n\t\t});\n\t\treturn this;\n\t}\n}\n\n\n\n//todo инструкция\n//todo синглплеер ~ треня\n//todo графоний\n\n\n// интерфейс по красоте, установить другой фон\n// реализовать логику выбора юнитов(их кол-во для атаки)\n// анимации\n","import Section from '../baseView.js';\nimport bus from '../../../modules/bus.js';\nimport Router from '../../../modules/router.js';\nimport User from '../../../modules/userModel.js';\n\n\n/**\n * Class represents Section with Menu buttons\n */\nexport default class MenuSection extends Section {\n\t/**\n     * Creates generic section\n     */\n\tconstructor(){\n\t\tsuper();\n\t\tthis.sign();\n\t}\n\n\t/**\n     * Renders and returns MenuSection DOM element\n     * @return {HTMLDivElement | *}\n     */\n\trender() {\n\t\tthis.menu = document.createElement('div');\n\t\tthis.attrsActive = [\n\t\t\t{\n\t\t\t\ttitle: 'singleplayer',\n\t\t\t\thref: '/singleplayer'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'multiplayer',\n\t\t\t\thref: '/multiplayer'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'profile',\n\t\t\t\thref: '/profile'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'rating',\n\t\t\t\thref: '/rating'\n\t\t\t},\n\t\t];\n\t\tthis.attrPassive = [\n\t\t\t{\n\t\t\t\ttitle: 'singleplayer',\n\t\t\t\thref: '/singleplayer'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Sign In',\n\t\t\t\thref: '/login'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Sign Up',\n\t\t\t\thref: '/register'\n\t\t\t},\n\t\t];\n\n\t\tif (User.isAuthorized()) {\n\t\t\tthis.menu.innerHTML = generateMenu({'attrs': this.attrsActive});\n\t\t\tthis.logout = document.createElement('a');\n\t\t\tthis.logout.setAttribute('href', '/');\n\t\t\tthis.logout.innerText = 'logout';\n\t\t\tthis.logout.addEventListener('click', (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tbus.emit('logout', null);\n\t\t\t});\n\t\t\tthis.logoutWrapper = document.createElement('div');\n\t\t\tthis.logoutWrapper.classList.add('button');\n\t\t\tthis.logoutWrapper.appendChild(this.logout);\n\t\t\tthis.menu.appendChild(this.logoutWrapper);\n\t\t}\n\t\telse {\n\t\t\tthis.menu.innerHTML = generateMenu({'attrs': this.attrPassive});\n\t\t}\n\t\treturn this.menu;\n\t}\n\n\tallowed() {\n\t\treturn true;\n\t}\n\n\tsign() {\n\t\tbus.on('user:authorized', (() => {\n\t\t\tthis.allow = true;\n\t\t\tnew Router().open('/menu');\n\t\t}));\n\n\t\tbus.on('user:unauthorized', (() => {\n\t\t\tthis.allow = false;\n\t\t}));\n\n\t\tbus.on('menu:hide', (() => {\n\t\t\tthis.hide();\n\t\t}));\n\t}\n\n\thide() {\n\t\tthis.menu.setAttribute('hidden', 'hidden');\n\t}\n}\n","import Form from './form.js';\nimport Input from '../blocks/input/input.js';\nimport Validator from '../../modules/validator.js';\n\n\n/**\n * Class representing Login Form\n */\nexport default class LoginForm extends Form {\n\t/**\n     * Creates generic form\n     */\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\t/**\n     * Return input data of the form\n     * @return {{name: null, email: string, password: string}}\n     */\n\tgetData() {\n\t\tconst email = this.Email.getData();\n\t\tconst password = this.Password.getData();\n\t\tif (email === '' || password === '') {\n\t\t\treturn null;\n\t\t}\n\t\treturn {\n\t\t\temail: email,\n\t\t\tpassword: password\n\t\t};\n\t}\n\n\t/**\n     * Renders and returns form DOM element\n     * @return {*}\n     */\n\trender() {\n\t\tthis.Email = new Input({\n\t\t\ttype: 'text',\n\t\t\tplaceholder: 'email',\n\t\t\tid: 'loginEmail'\n\t\t});\n\n\t\tthis.Password = new Input({\n\t\t\ttype: 'password',\n\t\t\tplaceholder: 'password',\n\t\t\tid: 'loginPassword'\n\t\t});\n\n\t\tthis.InputSubmit = new Input({\n\t\t\ttype: 'submit',\n\t\t\tvalue: 'Sign In',\n\t\t\tid: 'loginSubmit'\n\t\t});\n\n\t\tthis.Email.setOnInputChange(() => {\n\t\t\tValidator.checkMail(this.Email);\n\t\t});\n\n\t\tthis.Password.setOnInputChange(() => {\n\t\t\tValidator.checkPass(this.Password);\n\t\t});\n\n\n\t\tthis.formElement.appendChild(this.Email.render());\n\t\tthis.formElement.appendChild(this.Password.render());\n\t\tthis.formElement.appendChild(this.InputSubmit.render());\n\n\t\treturn this.formElement;\n\t}\n\n\t/**\n     * Defines behaviour on submit\n     * @param {function} callbackfn – submit handler\n     */\n\tsetOnSubmit(callbackfn) {\n\t\tthis.formElement.addEventListener('submit', (ev) => {\n\t\t\tev.preventDefault();\n\t\t\tcallbackfn();\n\t\t});\n\t}\n\n}\n","/* eslint-disable no-undef */\nimport Section from '../baseView.js';\nimport LoginForm from '../../forms/loginForm.js';\nimport bus from '../../../modules/bus.js';\nimport User from '../../../modules/userModel.js';\n\n/** Class represents section with Login Form */\nexport default class LoginSection extends Section {\n\t/**\n     * Creates generic section\n     */\n\tconstructor() {\n\t\tsuper();\n\t\tthis.sign();\n\t}\n\n\t/**\n     * Renders and returns LoginSection DOM element\n     * @return {HTMLDivElement | *}\n     */\n\trender() {\n\n\t\tthis.login = document.createElement('div');\n\t\tthis.login.innerHTML = generateLogin();\n\t\tthis.after = this.login.getElementsByClassName('button')[0];\n\n\t\tthis.loginForm = new LoginForm();\n\n\t\tthis.login.firstChild.insertBefore(this.loginForm.render(), this.after);\n\n\n\t\tthis.loginForm.setOnSubmit(() => {\n\t\t\tconst userData = this.loginForm.getData();\n\t\t\tif (userData === null) {\n\t\t\t\tthis.loginForm.Email.setError('empty fields');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst jsonUserData = JSON.stringify(userData);\n\t\t\tconsole.log(jsonUserData);\n\t\t\tbus.emit('user:login', jsonUserData);\n\t\t});\n\t\treturn this.login;\n\t}\n\n\tallowed() {\n\t\treturn !User.isAuthorized();\n\t}\n\n\tsign() {\n\t\tbus.on('login-error', (error) => {\n\t\t\tthis.loginForm.Email.setError(error.payload);\n\t\t});\n\t}\n}\n","import http from './http.js';\nimport route from '../conf/route.js';\nimport bus from './bus.js';\nimport Router from './router.js';\nimport User from './userModel.js';\n// error transformer\n\n/**\n * Class represents set of tools to work with User data\n */\nclass UserController {\n\t/**\n     * Creates user and loads user data\n     */\n\tconstructor() {\n\t\tif (UserController.__instance) {\n\t\t\treturn UserController.__instance;\n\t\t}\n\t\tbus.on('user:signup', (data) => {\n\t\t\tconst user = data.payload;\n\t\t\tUser.signUp(user)\n\t\t\t\t.then(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tnew Router().open('/');\n\t\t\t\t\t})\n\t\t\t\t.catch(\n\t\t\t\t\terror => {\n\t\t\t\t\t\tbus.emit('signup-error', error);\n\t\t\t\t\t});\n\n\t\t});\n\t\tbus.on('logout', () => {\n\t\t\tUser.logout()\n\t\t\t\t.then(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tnew Router().open('/');\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t.catch(\n\t\t\t\t\terror => {\n\t\t\t\t\t\tbus.emit('logout-error', error);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t});\n\n\t\tbus.on('user:login', (data) => {\n\t\t\tconst user = data.payload;\n\t\t\tUser.signIn(user)\n\t\t\t\t.then(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tnew Router().open('/');\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t.catch(\n\t\t\t\t\terror => {\n\t\t\t\t\t\tbus.emit('login-error', error);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t});\n\t\tbus.on('user:update', (data) => {\n\t\t\tconst user = data.payload;\n\t\t\tUser.update(user)\n\t\t\t\t.then(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tnew Router().open('/');\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t.catch(\n\t\t\t\t\terror => {\n\t\t\t\t\t\tbus.emit('update-error', error);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t});\n\t\tbus.on('user:avatarUpload', (data) => {\n\t\t\tconst avatar = data.payload;\n\t\t\tconsole.log(avatar);\n\t\t\tUser.uploadAvatar(avatar)\n\t\t\t\t.then(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tnew Router().open('/profile');\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t.catch(\n\t\t\t\t\terror => {\n\t\t\t\t\t\tconsole.log(error);\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t});\n\n\n\t\tUserController.__instance = this;\n\t}\n\n\n\t/**\n     * Loads Rating of all Users\n     * @param page\n     * @param {function} callbackfn\n     * @return {PromiseLike<T>|Promise<T>}\n     */\n\trating(page, callbackfn) {\n\t\treturn http.get(route.userAPIMethods.leaderBoard + '/' + page.toString(), callbackfn);\n\t}\n\n}\nconst userController = new UserController();\nexport default userController;","'use strict';\nimport Section from '../baseView.js';\nimport UserController from '../../../modules/userController.js';\nimport Button from '../../blocks/button.js';\nimport bus from '../../../modules/bus.js';\nimport Router from '../../../modules/router.js';\nimport User from '../../../modules/userModel.js';\n\n\n/**\n * Class represents Section with Rating Table\n */\nexport default class RatingSection extends Section {\n\t/**\n     * Creates generic Section\n     */\n\tconstructor() {\n\t\tsuper();\n\t\tthis.page = 1;\n\t\tthis.sign();\n\t}\n\n\t/**\n     * Renders and returns RaringSection DOM element\n     * @return {HTMLDivElement | *}\n     */\n\trender() {\n\t\tthis.rating = document.createElement('div');\n\t\tthis.rating.innerHTML = '';\n\n\t\tthis.paginationWrap = document.createElement('div');\n\t\tthis.paginationWrap.classList.add('pagination');\n\n\t\tthis.prevButt = document.createElement('a');\n\t\tthis.prevButt.innerText = '<';\n\t\tthis.prevButt.addEventListener('click', event => {\n\t\t\tevent.preventDefault();\n\n\t\t\tthis.rating.removeChild(this.rating.firstChild);\n\t\t\tthis.page--;\n\t\t\tthis.prevButt.hidden = this.page === 1;\n\t\t\tthis.nextButt.hidden = false;\n\t\t\tthis.load(this.page);\n\t\t});\n\t\tthis.nextButt = document.createElement('a');\n\n\n\t\tthis.nextButt.innerText = '>';\n\t\tthis.nextButt.addEventListener('click', event => {\n\t\t\tevent.preventDefault();\n\n\t\t\tthis.rating.removeChild(this.rating.firstChild);\n\t\t\tthis.page++;\n\t\t\tif (this.page !== 1) {\n\t\t\t\tthis.prevButt.hidden = false;\n\t\t\t}\n\t\t\tthis.load(this.page, (empty) => {\n\t\t\t\tif (empty) {\n\t\t\t\t\tthis.nextButt.hidden = true;\n\t\t\t\t\tthis.lastPage = document.createElement('div');\n\t\t\t\t\tthis.lastPage.innerText = 'This is the last page';\n\t\t\t\t\tthis.rating.insertBefore(this.lastPage, this.rating.firstChild);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\tthis.prevButt.hidden = this.page === 1;\n\n\t\tthis.paginationWrap.appendChild(this.prevButt);\n\t\tthis.paginationWrap.appendChild(this.nextButt);\n\n\t\tthis.backButtWrap = document.createElement('div');\n\t\tthis.backButtWrap.classList.add('button');\n\t\tthis.backButtWrap.classList.add('back-button');\n\n\t\tthis.backButt = document.createElement('a');\n\t\tthis.backButt.setAttribute('href', '/');\n\t\tthis.backButt.innerText = 'Back to menu';\n\t\tthis.backButtWrap.appendChild(this.backButt);\n\n\t\tthis.load(1, ()=>{});\n\t\tthis.rating.appendChild(this.paginationWrap);\n\t\tthis.rating.appendChild(this.backButtWrap);\n\t\treturn this.rating;\n\t}\n\n\tload(page, callbackfn) {\n\t\tconsole.log(page);\n\n\t\tUserController.rating( page, (err, users) => {\n\t\t\tif (err) {\n\t\t\t\tconsole.error(err);\n\t\t\t\tcallbackfn(true);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconsole.log(err, users);\n\n\t\t\tusers.then(\n\t\t\t\tdata => {\n\t\t\t\t\tthis.table = document.createElement('div');\n\t\t\t\t\tthis.table.innerHTML = generateRating({'data': data[0], 'user': data[1][0],\n\t\t\t\t\t'pages': data[2][0], 'page': page});\n\t\t\t\t\tthis.rating.insertBefore(this.table, this.rating.firstChild);\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\tsign() {\n\t\tbus.on('user:authorized', ((data) => {\n\t\t\tthis.allowed = true;\n\t\t}));\n\n\t\tbus.on('user:unauthorized', ((data) => {\n\t\t\tthis.allowed = false;\n\t\t}));\n\t}\n\n\tallowed() {\n\t\treturn User.isAuthorized();\n\t}\n}","import Form from '../form.js';\nimport Input from '../../blocks/input/input.js';\n\n/**\n * Class representing Load form\n */\nexport default class LoadForm extends Form {\n\t/**\n\t * creates loadForm\n\t * @param type\n\t */\n\tconstructor(type) {\n\t\tsuper();\n\t}\n\n\t/**\n\t * returns data of loadForm\n\t * @return {*}\n\t */\n\tgetData() {\n\t\tconst avatar = this.UploadInput.getFormData();\n\t\tif (avatar === '') {\n\t\t\treturn null;\n\t\t}\n\t\treturn {\n\t\t\tavatar: avatar\n\t\t};\n\t}\n\n\t/**\n\t * @return {HTMLDivElement}\n\t */\n\trender() {\n\t\tthis.UploadInput = new Input({\n\t\t\ttype: 'file',\n\t\t\tplaceholder: '',\n\t\t\tid: 'loadImageInput'\n\t\t});\n\t\tthis.UploadSubmit = new Input({\n\t\t\ttype: 'submit',\n\t\t\tvalue: 'Save picture',\n\t\t\tid: 'loadImageSubmit'\n\t\t});\n\n\t\tthis.formElement.appendChild(this.UploadInput.render());\n\t\tthis.formElement.appendChild(this.UploadSubmit.render());\n\n\t\tthis.formElement.setAttribute('enctype', 'multipart/form-data');\n\t\tthis.formElement.setAttribute('name', 'form_loadFile');\n\t\tthis.formElement.classList.add('form-loadFile');\n\n\t\treturn this.formElement;\n\t}\n\n\tsetOnSubmit(callbackfn) {\n\t\tthis.formElement.addEventListener('submit', (ev) => {\n\t\t\tev.preventDefault();\n\t\t\tcallbackfn();\n\t\t});\n\t}\n}","/**\n * Removes children of the root element and puts new child into it\n * @param {HTMLDivElement} child\n * @param {HTMLDivElement} root\n */\nexport default function renderDOM(child, root) {\n\twhile (root.firstChild) {\n\t\troot.removeChild(root.firstChild);\n\t}\n\troot.appendChild(child);\n}","import renderDOM from '../components/render/render.js';\n\n/**\n * Class represents set of tools for switching sections\n */\nclass SectionSwitcher {\n\tconstructor() {}\n\n\t/**\n     * Switches sections\n     * @param newSection\n     * @param rootForElement\n     */\n\tchangeSection(newSection, rootForElement) {\n\t\trenderDOM(newSection, rootForElement);\n\t}\n}\n\nconst sectionSwitcher = new SectionSwitcher();\n\nexport {sectionSwitcher};\n\nexport default SectionSwitcher;\n\n\n","import Form from './form.js';\nimport Input from '../blocks/input/input.js';\nimport Validator from '../../modules/validator.js';\n\n/**\n * Class representing form to change user data\n */\nexport default class ChangeForm extends Form {\n\t/**\n\t * creates ChangeForm\n\t */\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\t/**\n\t * returns data of the form\n\t * @return {{oldp: string, newp: string}}\n\t */\n\tgetData() {\n\t\treturn {\n\t\t\toldp: this.OldPassword.getData(),\n\t\t\tnewp: this.Password.getData()\n\t\t};\n\t}\n\n\t/**\n\t * @return {HTMLDivElement}\n\t */\n\trender() {\n\n\t\tthis.OldPassword = new Input({\n\t\t\ttype: 'password',\n\t\t\tplaceholder: 'old password',\n\t\t\tid: 'changeOld'\n\t\t});\n\n\t\tthis.Password = new Input({\n\t\t\ttype: 'password',\n\t\t\tplaceholder: 'new password',\n\t\t\tid: 'changeNew'\n\t\t});\n\n\t\tthis.RepeatPassword = new Input({\n\t\t\ttype: 'password',\n\t\t\tplaceholder: 'repeat password',\n\t\t\tid: 'changeRepeat'\n\t\t});\n\n\t\tthis.InputSubmit = new Input({\n\t\t\ttype: 'submit',\n\t\t\tvalue: 'Save',\n\t\t\tid: 'changeSubmit'\n\t\t});\n\n\t\t//TODO:: бэк\n\t\tthis.OldPassword.setOnInputChange(() => {\n\t\t\tValidator.checkPass(this.OldPassword);\n\t\t});\n\t\tthis.Password.setOnInputChange(() => {\n\t\t\tValidator.checkPass(this.Password);\n\t\t});\n\t\tthis.RepeatPassword.setOnInputChange(() => {\n\t\t\tValidator.checkConfirm(this.Password, this.RepeatPassword);\n\t\t});\n\n\t\tthis.formElement.appendChild(this.OldPassword.render());\n\t\tthis.formElement.appendChild(this.Password.render());\n\t\tthis.formElement.appendChild(this.RepeatPassword.render());\n\t\tthis.formElement.appendChild(this.InputSubmit.render());\n\n\n\t\treturn this.formElement;\n\t}\n\n\t/**\n\t * Sets submit listener\n\t * @param callbackfn\n\t */\n\tsetOnSubmit(callbackfn) {\n\t\tthis.formElement.addEventListener('submit', (ev) => {\n\t\t\tev.preventDefault();\n\t\t\tcallbackfn();\n\t\t});\n\t}\n}","import Section from '../baseView.js';\nimport ChangeForm from '../../forms/changeForm.js';\nimport Button from '../../blocks/button.js';\nimport bus from '../../../modules/bus.js';\nimport User from '../../../modules/userModel.js';\nimport Router from '../../../modules/router.js';\nimport LoadForm from '../../forms/loadPictureForm/loadPictureForm.js';\n\n/**\n * Class represents Section with Profile data and Form\n */\nexport default class ProfileSection extends Section {\n\t/**\n     * Creates generic Section\n     */\n\tconstructor() {\n\t\tsuper();\n\t\tthis.sign();\n\t}\n\n\t/**\n     * Renders and returns ProfileSection DOM element\n     * @return {HTMLDivElement | *}\n     */\n\trender() {\n\t\tthis.profileElement = document.createElement('div');\n\t\tthis.profileElement.classList.add('div__profile-wrapper');\n\n\t\tthis.attrs = User.getCurUser();\n\t\tthis.profileTable = document.createElement('div');\n\t\tthis.profileTable.innerHTML = generateProfile({'user': this.attrs});\n\t\tthis.profileElement.appendChild(this.profileTable);\n\t\tthis.profileElement.appendChild(document.createElement('hr'));\n\n\t\tthis.fileForm = new LoadForm();\n\t\tthis.profileElement.appendChild(this.fileForm.render());\n\n\t\tthis.changeForm = new ChangeForm();\n\t\tthis.profileElement.appendChild(this.changeForm.render());\n\n\t\tthis.backButt = new Button('button', 'Back', this.profileElement);\n\t\tthis.backButt.setOnClick(() => {\n\t\t\tnew Router().open('/');\n\t\t});\n\n\t\tthis.changeForm.setOnSubmit( () => {\n\t\t\tconst userData = this.changeForm.getData();\n\t\t\tconst jsonUserData = JSON.stringify(userData);\n\t\t\tbus.emit('user:update', jsonUserData);\n\t\t});\n\t\tthis.fileForm.setOnSubmit( () => {\n\t\t\t//TODO:\n\t\t\tconst file = document.getElementById('loadImageInput');\n\t\t\tconst formData = new FormData();\n\t\t\tconst upload = file.files[0];\n\n\t\t\tformData.append('image', upload);\n\n\t\t\tbus.emit('user:avatarUpload', formData);\n\t\t});\n\t\treturn this.profileElement;\n\t}\n\n\tallowed() {\n\t\treturn User.isAuthorized();\n\t}\n\n\tsign() {\n\t\tbus.on('update:error', data => {\n\t\t\tthis.changeForm.Email.setError(data.payload);\n\t\t});\n\t}\n}","import Form from './form.js';\nimport Input from '../blocks/input/input.js';\nimport Validator from '../../modules/validator.js';\n// validator\n// и какие-то глобальные переменные\n/**\n * Class representing registration form\n */\nexport default class RegisterForm extends Form {\n\t/**\n\t * creates RegisterForm\n\t */\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\t/**\n\t * @return {HTMLDivElement}\n\t */\n\trender() {\n\t\tthis.Email = new Input({\n\t\t\ttype: 'text',\n\t\t\tplaceholder: 'email',\n\t\t\tid: 'registerEmail'\n\t\t});\n\n\t\tthis.Name = new Input({\n\t\t\ttype: 'text',\n\t\t\tplaceholder: 'name',\n\t\t\tid: 'registerName'\n\t\t});\n\n\t\tthis.Password = new Input({\n\t\t\ttype: 'password',\n\t\t\tplaceholder: 'password',\n\t\t\tid: 'registerPass'\n\t\t});\n\n\t\tthis.ConfirmPassword = new Input({\n\t\t\ttype: 'password',\n\t\t\tplaceholder: 'confirm password',\n\t\t\tid: 'registerPass2'\n\t\t});\n\n\t\tthis.InputSubmit = new Input({\n\t\t\ttype: 'submit',\n\t\t\tvalue: 'Sign Up',\n\t\t\tid: 'registerSubmit'\n\t\t});\n\n\n\t\tthis.Email.setOnInputChange(() => {\n\t\t\tValidator.checkMail(this.Email);\n\t\t});\n\t\tthis.Name.setOnInputChange(() => {\n\t\t\tValidator.checkName(this.Name);\n\t\t});\n\t\tthis.Password.setOnInputChange(() => {\n\t\t\tValidator.checkPass(this.Password);\n\t\t});\n\t\tthis.ConfirmPassword.setOnInputChange(() => {\n\t\t\tValidator.checkConfirm(this.Password, this.ConfirmPassword);\n\t\t});\n\n\t\tthis.formElement.appendChild(this.Email.render());\n\t\tthis.formElement.appendChild(this.Name.render());\n\t\tthis.formElement.appendChild(this.Password.render());\n\t\tthis.formElement.appendChild(this.ConfirmPassword.render());\n\t\tthis.formElement.appendChild(this.InputSubmit.render());\n\n\t\treturn this.formElement;\n\t}\n\n\tgetData() {\n\t\tconst name = this.Name.getData();\n\t\tconst email = this.Email.getData();\n\t\tconst password = this.Password.getData();\n\t\tif (name === '' || email === '' || password === '') {\n\t\t\treturn null;\n\t\t}\n\t\treturn {\n\t\t\tusername: name,\n\t\t\temail: email,\n\t\t\tpassword: password\n\t\t};\n\t}\n\n\n\n\tsetOnSubmit(callbackfn) {\n\t\tthis.formElement.addEventListener('submit', (ev) => {\n\t\t\tev.preventDefault();\n\t\t\tcallbackfn();\n\t\t});\n\t}\n}\n","/* eslint-disable no-undef */\nimport Section from '../baseView.js';\nimport RegisterForm from '../../forms/registerForm.js';\n\nimport bus from '../../../modules/bus.js';\nimport User from '../../../modules/userModel.js';\n\n\n\n/**\n * Class represents Section with Registration Form\n */\nexport default class RegisterSection extends Section {\n\t/**\n     * Creates generic Section and wraps into Parent element\n     * @param parent\n     */\n\tconstructor() {\n\t\tsuper();\n\t\tUser.isAuthorized();\n\t\tthis.sign();\n\t}\n\n\t/**\n     * Renders and returns RegisterSection DOM element\n     * @return {HTMLDivElement}\n     */\n\trender() {\n\t\tthis.register = document.createElement('div');\n\t\tthis.register.innerHTML = generateRegister();\n\t\tthis.registerForm = new RegisterForm();\n\t\tthis.after = this.register.getElementsByClassName('button')[0];\n\t\tthis.register.firstChild.insertBefore(this.registerForm.render(), this.after);\n\t\tthis.registerForm.setOnSubmit( () => {\n\n\t\t\tconst userData = this.registerForm.getData();\n\t\t\tconsole.log(userData);\n\t\t\tif (userData === null) {\n\t\t\t\tthis.registerForm.Email.setError('Empty fields');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst jsonUserData = JSON.stringify(userData);\n\t\t\tbus.emit('user:signup', jsonUserData);\n\t\t\tbus.on('signup-error', (error) => {\n\t\t\t\tthis.registerForm.Email.setError(error.payload);\n\t\t\t});\n\n\t\t});\n\t\treturn this.register;\n\t}\n\n\tallowed() {\n\t\treturn !User.isAuthorized();\n\t}\n\n\tsign() {\n\n\t\tbus.on('signup-error', (error) => {\n\t\t\tthis.registerForm.Email.setError(error.payload);\n\t\t});\n\n\t}\n}\n","import Player from './player.js';\n\n/**\n * Class representing web player\n */\nexport default class WebPlayer extends Player {\n\t/**\n\t * creates web player\n\t */\n\tconstructor(name, color, canvas,  img) {\n\t\tsuper(name, color, canvas,  img);\n\t\tthis.listeners();\n\t}\n\n\tlisteners() {\n\n\t}\n}","\n\nexport const aboutRegion = (curRegion, domElem) => {\n\tdomElem.innerText = '';\n\tdomElem.innerText += 'name: ';\n\tdomElem.innerText += curRegion.name;\n\tdomElem.innerText += ' \\n';\n\tdomElem.innerText += 'region: ';\n\tdomElem.innerText += curRegion.gameData.units;\n};\n","/* eslint-disable no-undef */\n\n/**\n * Answers if the point is in Hexagon\n * @param x\n * @param y\n * @param xp\n * @param yp\n * @return {boolean}\n */\nconst inHex = (x, y, xp, yp) => {\n\tlet npol = xp.length;\n\tlet j = npol - 1;\n\tlet c = false;\n\tfor (let i = 0; i < npol; i++){\n\t\tif ((((yp[i]<=y) && (y<yp[j])) || ((yp[j]<=y) && (y<yp[i]))) &&\n\t\t\t(x > (xp[j] - xp[i]) * (y - yp[i]) / (yp[j] - yp[i]) + xp[i])) {\n\t\t\tc = !c;\n\t\t}\n\t\tj = i;\n\t}\n\treturn c;\n};\n\nexport default inHex;","/* eslint-disable indent,no-case-declarations,no-console */\nimport inHex from './math/inHex.js';\nimport bus from '../bus.js';\nimport PLAYER_STATES from './config/playerStates.js';\nimport {aboutRegion} from './helperFuncs/renderInfoAboutRegion.js';\nimport Ws from '../ws.js';\nimport {GameModes} from './config/modes.js';\n\n/**\n * Class representing Game Scene (Set of graphical and logical elements)\n */\nexport default class GameScene {\n\t/**\n\t * Creates scene\n\t * @param canvas\n\t * @param players\n\t * @param regions\n\t * @param switcher\n\t * @param mode\n\t */\n\tconstructor(canvas, players, regions, mode) {\n\t\tthis.mode = mode;\n\t\tthis.canvas  = canvas;\n\t\tthis.game_ctx = canvas.getContext('2d');\n\t\tthis.players = players;\n\t\tthis.regions = regions;\n\t\tthis.about_region = document.getElementById('about-region');\n\t\tconsole.log(this.players);\n\t\tthis.setPlayersRegions();\n\t\tif (mode === GameModes.multiplayer) {\n\t\t\tthis.ws = new Ws();\n\t\t}\n\t}\n\n\t/**\n\t * Returns current player\n\t * @return {*}\n\t */\n\tcurrentPlayer() {\n\t\tfor (let i = 0; i < this.players.length; ++i) {\n\t\t\t// TODO проверить работает ли это условие\n\t\t\tif (this.players[i].status !== PLAYER_STATES.DISABLED ) {\n\t\t\t\treturn this.players[i];\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Returns next player\n\t * @return {*}\n\t */\n\tnextPlayer() {\n\t\tconst curP = this.currentPlayer();\n\t\tfor (let i = 0; i < this.players.length; ++i) {\n\t\t\tif (this.players[i] === curP) {\n\t\t\t\ti = (i + 1) % this.players.length;\n\t\t\t\treturn this.players[i];\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Returns pointed region\n\t * @param x\n\t * @param y\n\t * @return {Region | null}\n\t */\n\tisRegion(x, y) {\n\t\tfor (let i = 0; i < this.regions.length; ++i) {\n\t\t\tif (inHex(x, y, this.regions[i].area.xp, this.regions[i].area.yp)) {\n\t\t\t\treturn this.regions[i];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t *\n\t * @param active\n\t * @param current\n\t * @return {boolean}\n\t */\n\tisNeighbour(active, current) {\n\t\tfor (let i = 0; i < active.neighbour.length; i++) {\n\t\t\tif (current.label === active.neighbour[i]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t *\n\t * @return {Region}\n\t */\n\tactiveRegion() {\n\t\tfor (let i = 0; i < this.regions.length; ++i) {\n\t\t\tif (this.regions[i].selected === true) {\n\t\t\t\treturn this.regions[i];\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t *\n\t */\n\tdeactivatePlayers() {\n\t\tthis.players.forEach(player => player.active = false);\n\t}\n\n\t/**\n\t * Sets regions for playes\n\t */\n\tsetPlayersRegions() {\n\t\t//todo шняга полная, надо переделать по-хорошему\n\t\tfor (let i = 0; i < this.players.length; i++ ) {\n\t\t\tthis.players[i].addRegion(this.regions[i]);\n\t\t}\n\t}\n\n\n\n\t/**\n\t * подписываемся на события кликов мышки\n\t */\n\tonListeners() {\n\t\tif (this.mode === GameModes.singleplayer) {\n\t\t\tbus.on('left-click', data => {\n\t\t\t\tconst curPlayer = this.currentPlayer();\n\t\t\t\tconst coordinates = data.payload;\n\t\t\t\tif (curPlayer.status === PLAYER_STATES.DISABLED) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst curRegion = this.isRegion(coordinates.x, coordinates.y);\n\t\t\t\tif (!curRegion) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tswitch (curPlayer.status) {\n\t\t\t\t\tcase PLAYER_STATES.DEFAULT:\n\t\t\t\t\t\tif (!curPlayer.isTheRegionOfPlayer(curRegion)) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurPlayer.status = PLAYER_STATES.READY;\n\n\t\t\t\t\t\t//выводим информацию о регионе\n\t\t\t\t\t\taboutRegion(curRegion, this.about_region);\n\t\t\t\t\t\tbus.emit('select-region', curRegion);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase PLAYER_STATES.READY:\n\t\t\t\t\t\tif (!this.currentPlayer().isTheRegionOfPlayer(curRegion)) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//если нажали на выделенный регион\n\t\t\t\t\t\tif (curRegion === this.activeRegion()) {\n\t\t\t\t\t\t\tcurPlayer.status = PLAYER_STATES.DEFAULT;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//выводим информацию о регионе\n\t\t\t\t\t\taboutRegion(curRegion, this.about_region);\n\t\t\t\t\t\tbus.emit('change-selection',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tactive: this.activeRegion(),\n\t\t\t\t\t\t\t\tnew: curRegion\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tbus.on('contextmenu', data => {\n\n\t\t\t\tconst curPlayer = this.currentPlayer();\n\t\t\t\tconst activeRegion = this.activeRegion();\n\t\t\t\tconst coordinates = data.payload;\n\t\t\t\tif (curPlayer.status === PLAYER_STATES.DISABLED || curPlayer.status !== PLAYER_STATES.READY) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst curRegion = this.isRegion(coordinates.x, coordinates.y);\n\t\t\t\tif (!curRegion) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\n\t\t\t\t//если не является регионом игрока\n\t\t\t\tif (!curPlayer.isTheRegionOfPlayer(curRegion)) {\n\t\t\t\t\t//если не является соседом, то выходим\n\t\t\t\t\tif (this.isNeighbour(activeRegion, curRegion) === false) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tbus.emit('attack', {\n\t\t\t\t\t\tfrom: this.activeRegion(),\n\t\t\t\t\t\tto: curRegion\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t//перемещаем юнитов между своими регионами\n\t\t\t\t\tcurRegion.gameData.units += activeRegion.gameData.units;\n\t\t\t\t\tactiveRegion.gameData.units = 0;\n\t\t\t\t\tbus.emit('move-units',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tactive: this.activeRegion(),\n\t\t\t\t\t\t\tnew: curRegion\n\t\t\t\t\t\t});\n\t\t\t\t\t//выводим информацию о регионе\n\t\t\t\t\taboutRegion(curRegion, this.about_region);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tbus.on('left-click-change', () => {\n\t\t\t\tconst curPlayer = this.currentPlayer();\n\t\t\t\tconst nextPlayer = this.nextPlayer();\n\t\t\t\tif (curPlayer.status === PLAYER_STATES.DISABLED) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tbus.emit('change-move', {\n\t\t\t\t\tcurrent: curPlayer,\n\t\t\t\t\tnext: nextPlayer,\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tbus.on('bot-attack', data => {\n\t\t\t\tconst regs = data.payload;\n\t\t\t\tfor (let i = 0; i < this.regions.length; ++i) {\n\t\t\t\t\tif (regs.to === this.regions[i].label) {\n\t\t\t\t\t\tconsole.log(regs.from.owner, '     ---------');\n\t\t\t\t\t\tbus.emit('attack', {\n\t\t\t\t\t\t\tfrom: regs.from,\n\t\t\t\t\t\t\tto: this.regions[i]\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tbus.on('bot-change-move', () => {\n\t\t\t\tbus.emit('change-move', {\n\t\t\t\t\tcurrent: this.currentPlayer(),\n\t\t\t\t\tnext: this.nextPlayer(),\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tbus.on('delete-from-queue', data => {\n\t\t\t\tconst player = data.payload;\n\t\t\t\t// console.log(this.players, '  b ');\n\t\t\t\tthis.players.forEach((cur, i) => {\n\t\t\t\t\tif (cur === player) {\n\t\t\t\t\t\tthis.players.splice(i, 1);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t// console.log(this.players, ' a');\n\t\t\t});\n\n\t\t\tbus.on('start-game', () => {\n\t\t\t\t//подсветка текущего игрока\n\t\t\t\tbus.emit('illum-cur', this.currentPlayer());\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\tbus.on('left-click', data => {\n\t\t\t\tconst coordinates = data.payload;\n\t\t\t\tconst curRegion = this.isRegion(coordinates.x, coordinates.y);\n\n\t\t\t\tif (!curRegion) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!this.players.isTheRegionOfPlayer(curRegion)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taboutRegion(curRegion, this.about_region);\n\n\t\t\t\tswitch (this.players.status) {\n\t\t\t\t\tcase PLAYER_STATES.DEFAULT:\n\t\t\t\t\t\tthis.players.status = PLAYER_STATES.READY;\n\t\t\t\t\t\tbus.emit('select-region', curRegion);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase PLAYER_STATES.READY:\n\t\t\t\t\t\tif (curRegion === this.activeRegion()) {\n\t\t\t\t\t\t\tthis.players.status = PLAYER_STATES.DEFAULT;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbus.emit('change-selection',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tactive: this.activeRegion(),\n\t\t\t\t\t\t\t\tnew: curRegion\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tbus.on('contextmenu', data => {\n\t\t\t\tconst activeRegion = this.activeRegion();\n\t\t\t\tconst coordinates = data.payload;\n\t\t\t\tif (this.players.status === PLAYER_STATES.DISABLED || this.players.status !== PLAYER_STATES.READY) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst curRegion = this.isRegion(coordinates.x, coordinates.y);\n\t\t\t\tif (!curRegion) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t//если не является соседом, то выходим\n\t\t\t\tif (this.isNeighbour(activeRegion, curRegion) === false) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tnew Ws().send('from-to', {\n\t\t\t\t\tfrom: this.activeRegion(),\n\t\t\t\t\tto: curRegion\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tbus.on('left-click-change', () => {\n\t\t\t\t// new Ws().send('change-move', {});\n\t\t\t\tbus.on('ws-change-move-confirm', (data) => {\n\t\t\t\t\t//TODO получить следующего игрока\n\t\t\t\t\tconsole.log(data);\n\t\t\t\t\tbus.emit('change-move', {});\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tbus.on('start-game', (data) => {\n\t\t\t\t//TODO получить текущего игрока и заэмитить его\n\t\t\t\tconsole.log(data);\n\t\t\t\t// bus.emit('illum-cur',{});\n\t\t\t});\n\t\t}\n\t}\n}\n","\nimport bus from '../bus.js';\n\n/**\n * Class representing set of game controls\n */\nexport default class Controller {\n\t/**\n\t * Creates controllers\n\t * @param game_canvas\n\t * @param change_canvas\n\t */\n\tconstructor(game_canvas, changeBut, mode) {\n\t\tthis.mode = mode;\n\t\tthis.game_canvas = game_canvas;\n\t\tthis.changeBut = changeBut;\n\t\t// this.change_canvas = change_canvas;\n\t\t// this.change_canvas.getContext('2d').transform(1,0,0,1, screen.width*0.7, 0);\n\n\t\tthis.onclick = (event) => {\n\t\t\tconsole.log(event.offsetX, ' ', event.offsetY);\n\t\t\t// console.log(event.offsetX * 1000 / this.game_canvas.width);\n\t\t\tbus.emit('left-click', {x: event.offsetX, y: event.offsetY});\n\t\t};\n\n\t\tthis.mousemove = (event) => {\n\t\t\tbus.emit('mousemove', {x: event.offsetX, y: event.offsetY});\n\t\t};\n\t\tthis.contextmenu = (event) => {\n\t\t\tevent.preventDefault();\n\t\t\tbus.emit('contextmenu', {x: event.offsetX, y: event.offsetY});\n\t\t};\n\t\tthis.clickChangeBut = (event) => {\n\t\t\tbus.emit('left-click-change', {});\n\t\t};\n\t\t// this.mousemovecanvas = (event) => {\n\t\t// \tbus.emit('mousemove-change', {x: event.x- screen.width * 0.8, y: event.y});\n\t\t// };\n\t\t// this.conkekstcanvas = (event) => {\n\t\t// \tevent.preventDefault();\n\t\t// \tbus.emit('contextmenu-change', {x: event.x - screen.width * 0.8, y: event.y});\n\t\t// };\n\t}\n\n\t/**\n\t * Turns controls on\n\t */\n\tstart() {\n\t\tthis.game_canvas.addEventListener('click', this.onclick);\n\n\t\tthis.game_canvas.addEventListener('mousemove', this.mousemove);\n\n\t\tthis.game_canvas.addEventListener('contextmenu', this.contextmenu);\n\n\t\tthis.changeBut.addEventListener('click', this.clickChangeBut);\n\t\t//\n\t\t// this.change_canvas.addEventListener('mousemove', this.mousemovecanvas);\n\t\t//\n\t\t// this.change_canvas.addEventListener('contextmenu', this.conkekstcanvas);\n\t}\n\n\t/**\n\t * Turn controls off\n\t */\n\tstop() {\n\t\tthis.game_canvas.removeEventListener('click', this.onclick);\n\n\t\tthis.game_canvas.removeEventListener('mousemove', this.mousemove);\n\n\t\tthis.game_canvas.removeEventListener('contextmenu', this.contextmenu);\n\n\t\tthis.changeBut.removeEventListener('click', this.clickChangeBut);\n\t\t//\n\t\t// this.change_canvas.removeEventListener('mousemove', this.mousemovecanvas);\n\t\t//\n\t\t// this.change_canvas.removeEventListener('contextmenu', this.conkekstcanvas);\n\t}\n}\n\n","import bus from '../../bus.js';\n\nexport const timer = (htmlElement) => {\n\tlet sec = 30;\n\tlet isPaused = false;\n\tlet g = setInterval(() => {\n\t\tif (isPaused) {\n\t\t\t++sec;\n\t\t}\n\t\thtmlElement.innerHTML = --sec;\n\t\tif (sec === 0) {\n\t\t\tclearInterval(g);\n\t\t\tbus.emit('left-click-change', {});\n\t\t}\n\t}, 1000);\n\tbus.on('left-click-change', () => {\n\t\t//sec = 0;\n\t\tclearInterval(g);\n\t});\n\tbus.on('attack', () => {\n\t\tisPaused = true;\n\t\tsetTimeout(() => {isPaused = false;}, 1000);\n\t});\n};","\nexport const battleCalc = (firstRegion, secondRegion) => {\n\t//todo КАКИЕ ТО ПРОЦЕНТЫ АААА\n\tconst result = firstRegion.gameData.units - secondRegion.gameData.units * 2;\n\tif (result > 0) {\n\t\tfirstRegion.gameData.units -= secondRegion.gameData.units * 2;\n\t\tsecondRegion.gameData.units = 0;\n\t\treturn true;\n\t} else {\n\t\tsecondRegion.gameData.units -= firstRegion.gameData.units / 2;\n\t\tfirstRegion.gameData.units = 0;\n\t\treturn false;\n\t}\n};","import {animate} from '../animate.js';\nexport const moveAnimation = (x, y, x2, y2) => {\n\n\tconst wrapper = document.getElementsByClassName('wrapper')[0];\n\tconst wrapAnim = document.createElement('div');\n\twrapAnim.classList.add('attack-animation');\n\twrapper.appendChild(wrapAnim);\n\twrapAnim.innerHTML = generateAttack(\n\t\t{\n\t\t\t'width': window.innerWidth * 0.7,\n\t\t\t'height': window.innerHeight,\n\t\t\t'id': 'attack-canvas'\n\t\t}\n\t);\n\tconst canvas = document.getElementById('attack-canvas');\n\tconst ctx = canvas.getContext('2d');\n\tconst cw = ctx.canvas.width;\n\tconst ch = window.innerHeight;\n\tconst lWidth = cw * 0.01;\n\t// canvas.style.marginTop = String(100 - 100 * canvas.height /window.innerHeight * 0.83) / 2 + '%';\n\tconst game_canvas = document.getElementById('game-canvas');\n\tlet result = window.getComputedStyle(game_canvas).marginTop.match(/^[0-9]+/);\n\tlet mTop = Number(result);\n\ty = y + mTop;\n\ty2 = y2 + mTop;\n\n\tconst length = (Math.sqrt((x-x2)*(x-x2) + (y-y2)*(y-y2)));\n\tlet curLength;\n\tlet curX;\n\tlet curY;\n\tlet arrowX;\n\tlet arrowY;\n\tlet arrowX2;\n\tlet arrowY2;\n\tlet constX;\n\tlet constY;\n\tlet diff;\n\tlet part;\n\tconst gradient = ctx.createLinearGradient(x2, y2, x, y);\n\tconst gradientStroke = ctx.createLinearGradient(x2, y2, x, y);\n\n\tanimate(timePassed => {\n\t\tdiff = (timePassed).toFixed(4);\n\t\tpart = diff / 1000;\n\t\tctx.clearRect(0, 0, cw, ch);\n\t\tctx.lineWidth = lWidth;\n\t\tgradient.addColorStop(0, '#030101');\n\t\tgradient.addColorStop(0.5, '#711615');\n\t\tgradient.addColorStop(1, '#ee2357');\n\n\t\tgradientStroke.addColorStop(0, '#030101');\n\t\tgradientStroke.addColorStop(0.5, '#0d3634');\n\t\tgradientStroke.addColorStop(1, '#ee2357');\n\n\n\t\tctx.fillStyle = gradient;\n\t\tctx.strokeStyle = gradientStroke;\n\n\t\tcurX = x2 + (x - x2) * part;\n\t\tcurY = y2 + (y - y2) * part;\n\t\tcurLength = Math.sqrt((curX - x2) * (curX - x2) + (curY - y2) * (curY - y2));\n\t\tif ( curLength <= 0.76 * length) {\n\t\t\tconstX = curX;\n\t\t\tconstY = curY;\n\t\t}\n\t\tif (curLength >= 0.75 * length) {\n\t\t\tarrowX = 0.2*(y - y2) + constX;\n\t\t\tarrowY = 0.2*(x2 - x) + constY;\n\t\t\tarrowX2 = -0.2*(y - y2) + constX;\n\t\t\tarrowY2 = -0.2*(x2 - x) + constY;\n\t\t\tctx.moveTo(arrowX, arrowY);\n\t\t\tctx.lineTo(arrowX  + (x - arrowX) * part, arrowY  + (y - arrowY) * part);\n\t\t\tctx.moveTo(arrowX2, arrowY2);\n\t\t\tctx.lineTo(arrowX2 + (x - arrowX2) * part, arrowY2  + (y  - arrowY2) * part);\n\t\t}\n\n\t\tctx.moveTo(x2, y2);\n\t\tctx.lineTo(curX, curY);\n\n\n\n\t\tctx.stroke();\n\t\tctx.fill();\n\n\t\t// ctx.arc(600, 100, 50, start, diff/10+start, false);\n\n\t}, 1000);\n\tsetTimeout(() => {\n\t\twrapper.removeChild(wrapper.lastChild);\n\t}, 1000);\n};","import {animate} from './animate.js';\n\nexport const animationOverlay = (x , y) => {\n\n\tconst wrapper = document.getElementsByClassName('wrapper')[0];\n\tconst wrapAnim = document.createElement('div');\n\twrapAnim.classList.add('overlay');\n\n\tconst canvas = document.createElement('canvas');\n\twrapAnim.appendChild(canvas);\n\tcanvas.setAttribute('id', 'overlay');\n\tcanvas.width = window.innerWidth;\n\tcanvas.height = window.innerHeight;\n\twrapper.appendChild(wrapAnim);\n\tconst ctx = canvas.getContext('2d');\n\t// canvas.style.marginTop = String(100 - 100 * canvas.height / window.innerHeight * 0.83) / 2 + '%';\n\tconst game_canvas = document.getElementById('game-canvas');\n\tlet result = window.getComputedStyle(game_canvas).marginTop.match(/^[0-9]+/);\n\tlet mTop = Number(result);\n\ty = y + mTop;\n\n\t//.style.marginTop = String(100 - 100 * canvas.height / window.innerHeight * 0.83) / 2 + '%';\n\tconst start = 4.72;\n\tconst cw = ctx.canvas.width;\n\tconst ch = ctx.canvas.height;\n\tlet diff;\n\tconst gradient = ctx.createLinearGradient(\n\t\tx - cw * 0.02 * 0.66,\n\t\ty - cw * 0.02 * 0.66,\n\t\tx + cw * 0.02 * 0.66,\n\t\ty + cw * 0.02 * 0.66\n\t);\n\tconst gradientStroke = ctx.createLinearGradient(\n\t\tx - cw * 0.02 * 0.66,\n\t\ty - cw * 0.02 * 0.66,\n\t\tx + cw * 0.02 * 0.66,\n\t\ty + cw * 0.02 * 0.66\n\t);\n\tanimate(function(timePassed) {\n\t\tdiff = ((timePassed / 1000) * Math.PI*2*10).toFixed(2);\n\t\tctx.clearRect(0, 0, cw, ch);\n\t\tctx.lineWidth = 10; //TODO шириной радиуса\n\t\tgradient.addColorStop(0, '#030101');\n\t\tgradient.addColorStop(0.5, '#711615');\n\t\tgradient.addColorStop(1, '#ee2357');\n\n\t\tgradientStroke.addColorStop(0, '#030101');\n\t\tgradientStroke.addColorStop(0.5, '#0d3634');\n\t\tgradientStroke.addColorStop(1, '#ffffff');\n\n\t\tctx.fillStyle = gradient;\n\t\tctx.strokeStyle = gradientStroke;\n\n\t\tctx.beginPath();\n\t\tctx.arc(x, y, cw * 0.02, start, diff/10+start, false);\n\t\tctx.stroke();\n\t\t// ctx.fill();\n\t}, 1000);\n\tsetTimeout(() => {\n\t\twrapper.removeChild(wrapper.lastChild);\n\t}, 1000);\n};","import {animate} from '../animate.js';\n\nexport const attackAnimation = (x, y, x2, y2) => {\n\tconst wrapper = document.getElementsByClassName('wrapper')[0];\n\tconst wrapAnim = document.createElement('div');\n\twrapAnim.classList.add('attack-animation');\n\twrapper.appendChild(wrapAnim);\n\twrapAnim.innerHTML = generateAttack(\n\t\t{\n\t\t\t'width': window.innerWidth * 0.7,\n\t\t\t'height': window.innerHeight,\n\t\t\t'id': 'attack-canvas'\n\t\t}\n\t);\n\tconst canvas = document.getElementById('attack-canvas');\n\tconst ctx = canvas.getContext('2d');\n\tconst cw = ctx.canvas.width;\n\tconst ch = window.innerHeight;\n\t// console.log(canvas.height, '  size   ', window.innerHeight * 0.83);\n\t// canvas.style.marginTop = String(100 - 100 * canvas.height / window.innerHeight * 0.83) / 2 + '%';\n\tconst game_canvas = document.getElementById('game-canvas');\n\tlet result = window.getComputedStyle(game_canvas).marginTop.match(/^[0-9]+/);\n\tlet mTop = Number(result);\n\ty = y + mTop;\n\ty2 = y2 + mTop;\n\tconst radius = cw * 0.03;\n\tconst lWidth = cw * 0.01;\n\tconst startX = (x - radius * Math.sin(Math.PI / 4));\n\tconsole.log(x, '  ', startX);\n\tconst startY = (y - radius * Math.sin(Math.PI / 4));\n\tconsole.log(y, '    ', startY);\n\tconst endX = (x + radius * Math.sin(Math.PI / 4));\n\tconst endY = (y + radius * Math.sin(Math.PI / 4));\n\tlet diff;\n\tlet part;\n\tconst gradient = ctx.createLinearGradient(startX, startY, endX, endY);\n\tconst gradientStroke = ctx.createLinearGradient(startX, startY, endX, endY);\n\n\tanimate(timePassed => {\n\t\tdiff = (timePassed).toFixed(2);\n\t\tpart = diff / 1000;\n\t\tctx.clearRect(0, 0, cw, ch);\n\t\tctx.lineWidth = lWidth;\n\t\tgradient.addColorStop(0, '#030101');\n\t\tgradient.addColorStop(0.5, '#711615');\n\t\tgradient.addColorStop(1, '#ee2357');\n\n\t\tgradientStroke.addColorStop(0, '#030101');\n\t\tgradientStroke.addColorStop(0.5, '#0d3634');\n\t\tgradientStroke.addColorStop(1, '#ee2357');\n\n\n\t\tctx.fillStyle = gradient;\n\t\tctx.strokeStyle = gradientStroke;\n\t\tconst secondX = 2 * radius * Math.sin(Math.PI / 4) + startX;\n\t\tif ( diff/10 + startX >= secondX) {\n\t\t\tdiff = 100;\n\t\t}\n\n\t\tctx.moveTo(startX, startY);\n\t\tctx.lineTo(diff/10 + startX, diff/10 + startY);\n\t\tctx.moveTo(secondX, startY);\n\t\tctx.lineTo(secondX - diff/10, diff/10 + startY);\n\n\t\tctx.moveTo(x2, y2);\n\t\tctx.lineTo(x2 + (x - x2) * part, y2 + (y - y2) * part);\n\n\n\t\tctx.stroke();\n\t\tctx.fill();\n\n\t\t// ctx.arc(600, 100, 50, start, diff/10+start, false);\n\n\t}, 1000);\n\tsetTimeout(() => {\n\t\twrapper.removeChild(wrapper.lastChild);\n\t}, 1000);\n\n};\n\n\n\n","import bus from '../bus.js';\nimport {attackAnimation} from './animation/attack/attackAnimation.js';\nimport {animationOverlay} from './animation/animationOverlay.js';\nimport {moveAnimation} from './animation/move/moveAnimation.js';\nimport {renderScene} from './helperFuncs/renderScene.js';\nimport {battleCalc} from './helperFuncs/battleCalc.js';\nimport PLAYER_STATES from './config/playerStates.js';\nimport MainPlayer from './player/mainPlayer.js';\nimport BotPlayer from './player/botPlayer.js';\nimport {timer} from './helperFuncs/timer.js';\n\n\n/**\n * Class representing game logic\n */\nexport default class GameManager {\n\t/**\n\t * Creates logic =)\n\t * @param controller\n\t */\n\tconstructor(controller, canvas, regions, img, mode) {\n\t\tthis.mode = mode;\n\t\tthis.controller = controller;\n\t\tthis.regions = regions;\n\t\tthis.canvas = canvas;\n\t\tthis.img = img;\n\t\tthis.timer = document.getElementById('timer');\n\t\tthis.log = document.getElementById('log');\n\t}\n\n\n\t/**\n\t * Starts game logic 8)\n\t */\n\tstart() {\n\t\ttimer(this.timer);\n\t\tthis.select_region = (data) => {\n\t\t\tconst region = data.payload;\n\t\t\tregion.selected = true;\n\t\t\tregion.area.setStroke('red');\n\t\t\t//todo:: попробовать запускать последовательно\n\t\t\trenderScene(this.canvas, this.regions, this.img);\n\t\t};\n\t\tthis.change_selection = (data) => {\n\t\t\tconst regions = data.payload;\n\t\t\tregions.active.selected = false;\n\t\t\tregions.new.selected = true;\n\t\t\tlet setNewColor = new Promise((resolve, reject) => {\n\t\t\t\tresolve(regions.new.area.setStroke('red'));\n\t\t\t});\n\t\t\tlet setActiveColor = new Promise((resolve, reject) => {\n\t\t\t\tresolve(regions.active.area.setStroke('white'));\n\t\t\t});\n\t\t\tsetNewColor\n\t\t\t\t.then(\n\t\t\t\t\t() => {\n\t\t\t\t\t\trenderScene(this.canvas, this.regions, this.img);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\tsetActiveColor\n\t\t\t\t.then(\n\t\t\t\t\t() => {\n\t\t\t\t\t\trenderScene(this.canvas, this.regions, this.img);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t};\n\t\tthis.attack = (data) => {\n\t\t\tanimationOverlay(window.innerWidth / 2, this.canvas.height * 0.92);\n\n\t\t\tconst regions = data.payload;\n\t\t\tconst from = regions.from;\n\t\t\tconst to = regions.to;\n\n\t\t\tattackAnimation(to.area.xC, to.area.yC, from.area.xC, from.area.yC);\n\n\n\t\t\t//true если первый, false если второй\n\t\t\tconst fromWin = battleCalc(from, to);\n\t\t\tsetTimeout(() => {\n\n\t\t\t\tif (fromWin) {\n\t\t\t\t\tto.setColor(from.getColor());\n\t\t\t\t\tto.owner.delRegion(to);\n\n\t\t\t\t\tif (to.owner.regions.length === 0) {\n\t\t\t\t\t\tto.owner.setStatus(PLAYER_STATES.DISABLED);\n\t\t\t\t\t\tbus.emit('delete-from-queue', to.owner);\n\n\t\t\t\t\t}\n\t\t\t\t\tbus.emit('update-neighbour', {\n\t\t\t\t\t\tfrom: from,\n\t\t\t\t\t\tto: to\n\t\t\t\t\t});\n\t\t\t\t\tfrom.owner.addRegion(to);\n\t\t\t\t\tto.area.setStroke('white');\n\t\t\t\t\trenderScene(this.canvas, this.regions, this.img);\n\t\t\t\t}\n\t\t\t}, 1000);\n\n\t\t\tthis.log.innerHTML = '<p>Player ' + from.name + ' attacked ' + to.name + '</p>';\n\t\t};\n\t\tthis.change_move = (dict) => {\n\t\t\tthis.regions.forEach(region => {\n\t\t\t\tregion.area.setStroke('black');\n\t\t\t});\n\t\t\tconst data = dict.payload;\n\t\t\t//data.switcher.reDraw('red');\n\t\t\tdata.current.setStatus(PLAYER_STATES.DISABLED);\n\t\t\tdata.next.setStatus(PLAYER_STATES.DEFAULT);\n\t\t\tif (data.next instanceof MainPlayer) {\n\t\t\t\t//вызываем таймер заного для текущего игрока\n\n\t\t\t\tdata.next.regions.forEach(region => {\n\t\t\t\t\tregion.area.setStroke('white');\n\t\t\t\t\trenderScene(this.canvas, this.regions, this.img);\n\t\t\t\t});\n\t\t\t\ttimer(this.timer);\n\t\t\t\tthis.controller.start();\n\t\t\t}\n\t\t\telse if (data.next instanceof BotPlayer) {\n\t\t\t\tdata.next.regions.forEach(region => {\n\t\t\t\t\tregion.area.setStroke('white');\n\t\t\t\t\trenderScene(this.canvas, this.regions, this.img);\n\t\t\t\t});\n\t\t\t\tthis.controller.stop();\n\t\t\t\tbus.emit('bot-move', data.next);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.controller.stop();\n\t\t\t}\n\t\t};\n\t\tthis.illum_cur = (data) => {\n\t\t\tconst curPlayer = data.payload;\n\t\t\tcurPlayer.regions.forEach(region => {\n\t\t\t\tregion.area.setStroke('white');\n\t\t\t\trenderScene(this.canvas, this.regions, this.img);\n\t\t\t});\n\t\t};\n\t\tthis.move_units = (data) => {\n\t\t\tconst regions = data.payload;\n\t\t\tregions.active.selected = false;\n\t\t\tregions.new.selected = true;\n\t\t\tregions.new.area.setStroke('red');\n\t\t\trenderScene(this.canvas, this.regions, this.img);\n\t\t\tregions.active.area.setStroke('white');\n\t\t\tmoveAnimation(\n\t\t\t\tregions.new.area.xC, regions.new.area.yC,\n\t\t\t\tregions.active.area.xC, regions.active.area.yC\n\t\t\t);\n\t\t\trenderScene(this.canvas, this.regions, this.img);\n\t\t};\n\n\t\tbus.on('change-selection', this.change_selection);\n\t\tbus.on('select-region', this.select_region);\n\t\tbus.on('change-move', this.change_move);\n\t\tbus.on('move-units', this.move_units);\n\t\tbus.on('illum-cur', this.illum_cur);\n\t\tbus.on('attack', this.attack);\n\t}\n\n\n\t/**\n\t * destroys game logic ;)\n\t */\n\tdestroy() {\n\t\tbus.off('change-selection', this.change_selection);\n\t\tbus.off('select-region', this.select_region);\n\t\tbus.off('change-move', this.change_move);\n\t\tbus.off('move-units', this.move_units);\n\t\tbus.off('illum-cur', this.illum_cur);\n\t\tbus.off('attack', this.attack);\n\t}\n}","export const reachMatrix = [\n\t[0, 1, 1, 1, 0],\n\t[1, 0, 1, 1, 1],\n\t[1, 1, 0, 0, 0],\n\t[1, 1, 0, 0, 1],\n\t[0, 1, 0, 1, 0]\n];","/* eslint-disable no-undef */\nimport bus from '../bus.js';\n\n/**\n * Class represents Hexagon graphical element\n */\nexport default class Hexagon {\n\t/**\n\t * Creates Hexagon\n\t * @param canvas\n\t * @param xC\n\t * @param yC\n\t * @param color\n\t */\n\tconstructor(name, canvas, xC, yC, color, coordinate) {\n\t\tthis.name = name;\n\t\tthis.canvas = canvas;\n\t\tthis.game_ctx = this.canvas.getContext('2d');\n\t\tthis.draw(xC, yC, color);\n\t\tthis.xC = xC;\n\t\tthis.yC = yC;\n\t\tthis.color = color;\n\t\tthis.strokeColor = 'black';\n\t\tbus.on('resize-for-draw', () => {\n\t\t\t//todo: далее с соседями\n\t\t\t//todo: сделать кексы прозрачными плюс фон\n\t\t\tfor (let i = 0; i < coordinate.allowedCoord.length; i++) {\n\t\t\t\t//console.log(coordinate.allowedCoord.length, '      length');\n\t\t\t\tif (coordinate.allowedCoord[i].name === this.name) {\n\t\t\t\t\tthis.xC = coordinate.allowedCoord[i].x;\n\t\t\t\t\tthis.yC = coordinate.allowedCoord[i].y;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} \n\t\t\tthis.draw();\n\n\t\t});\n\t}\n\n\t/**\n\t * Draws graphical element\n\t * @param xC\n\t * @param yC\n\t * @param color\n\t */\n\n\tsetColor(color) {\n\t\tthis.color = color;\n\t}\n\tgetColor() {\n\t\treturn this.color;\n\t}\n\tsetStroke(color) {\n\t\tthis.strokeColor = color;\n\t}\n\n\tdraw() {\n\t\tconst amountofCoorX = 1000;\n\t\tconst amountofCoorY = 610;\n\t\tthis.R = 90;\n\t\tthis.dR = this.R * 0.866;\n\t\tthis.xp = [\n\t\t\tthis.xC - this.R * this.canvas.width / amountofCoorX,\n\t\t\tthis.xC - this.R / 2 *  this.canvas.width / amountofCoorX,\n\t\t\tthis.xC + this.R / 2 *  this.canvas.width / amountofCoorX,\n\t\t\tthis.xC + this.R * this.canvas.width / amountofCoorX,\n\t\t\tthis.xC + this.R / 2 * this.canvas.width / amountofCoorX,\n\t\t\tthis.xC - this.R / 2 * this.canvas.width / amountofCoorX,\n\t\t\tthis.xC - this.R * this.canvas.width / amountofCoorX\n\t\t];\n\t\tthis.yp = [\n\t\t\tthis.yC,\n\t\t\tthis.yC + this.dR * this.canvas.height / amountofCoorY,\n\t\t\tthis.yC + this.dR * this.canvas.height / amountofCoorY,\n\t\t\tthis.yC,\n\t\t\tthis.yC - this.dR * this.canvas.height / amountofCoorY,\n\t\t\tthis.yC - this.dR *this.canvas.height / amountofCoorY,\n\t\t\tthis.yC\n\t\t];\n\t\tthis.game_ctx.beginPath();\n\t\tthis.game_ctx.lineJoin = 'round';\n\t\tthis.game_ctx.lineWidth = 4;\n\t\tthis.game_ctx.moveTo(this.xp[0], this.yp[0]);\n\t\tfor (let i = 1; i < this.xp.length; ++i) {\n\t\t\tthis.game_ctx.lineTo(this.xp[i], this.yp[i]);\n\t\t}\n\t\tthis.game_ctx.strokeStyle = this.strokeColor;\n\t\tthis.game_ctx.stroke();\n\t\tthis.game_ctx.fillStyle = this.color;\n\t\t// this.game_ctx.fillStyle = 'rgba(100,150,185,0.4)';\n\t\tthis.game_ctx.fill();\n\t\tthis.game_ctx.closePath();\n\t}\n\n\n\n\treColor () {\n\t\tconst amountofCoorX = 1000;\n\t\tconst amountofCoorY = 610;\n\t\tthis.xp = [\n\t\t\tthis.xC - this.R * this.canvas.width / amountofCoorX,\n\t\t\tthis.xC - this.R / 2 *  this.canvas.width / amountofCoorX,\n\t\t\tthis.xC + this.R / 2 *  this.canvas.width / amountofCoorX,\n\t\t\tthis.xC + this.R * this.canvas.width / amountofCoorX,\n\t\t\tthis.xC + this.R / 2 * this.canvas.width / amountofCoorX,\n\t\t\tthis.xC - this.R / 2 * this.canvas.width / amountofCoorX,\n\t\t\tthis.xC - this.R * this.canvas.width / amountofCoorX\n\t\t];\n\t\tthis.yp = [\n\t\t\tthis.yC,\n\t\t\tthis.yC + this.dR * this.canvas.height / amountofCoorY,\n\t\t\tthis.yC + this.dR * this.canvas.height / amountofCoorY,\n\t\t\tthis.yC,\n\t\t\tthis.yC - this.dR * this.canvas.height / amountofCoorY,\n\t\t\tthis.yC - this.dR *this.canvas.height / amountofCoorY,\n\t\t\tthis.yC\n\t\t];\n\t\tthis.game_ctx.beginPath();\n\t\t// this.game_ctx.lineJoin = 'round';\n\t\t// this.game_ctx.lineWidth = 1;\n\t\tthis.game_ctx.moveTo(this.xp[0], this.yp[0]);\n\t\tfor (let i = 1; i < this.xp.length; ++i) {\n\t\t\tthis.game_ctx.lineTo(this.xp[i], this.yp[i]);\n\t\t}\n\t\tthis.game_ctx.strokeStyle = 'rgba(255,255,255,0.8)';\n\t\tthis.game_ctx.stroke();\n\t\t// this.game_ctx.fillStyle = this.color;\n\t\t// // this.game_ctx.fillStyle = 'rgba(100,150,185,0.4)';\n\t\t// this.game_ctx.fill();\n\t\tthis.game_ctx.closePath();\n\t}\n\n}","/* eslint-disable no-undef */\nimport Hexagon from '../../graphics/hexagon.js';\nimport {reachMatrix} from '../config/reach.js';\nimport bus from '../../bus.js';\n/**\n * Class representing game region\n */\nexport default class Region {\n\t/**\n\t * Creates Region\n\t * @param name\n\t * @param owner\n\t * @param canvas\n\t * @param coordinate\n\t */\n\tconstructor(name, owner, canvas, coordinate, units) {\n\t\tthis.name = name;\n\t\tthis.canvas = canvas;\n\t\tthis.game_ctx = this.canvas.getContext('2d');\n\t\tthis.selected = false;\n\t\tthis.allowedCoordinates = coordinate.allowedCoord;\n\t\tthis.coordinate = coordinate;\n\t\tthis.owner = owner;\n\t\tthis.color = owner.color;\n\t\tthis.gameData = {\n\t\t\tunits: units\n\t\t};\n\t\tthis.setBusListeners();\n\t\tthis.area = null;\n\t\tthis.label = null;\n\t\tthis.globalRegions = null;\n\t\tthis.neighbour = null;\n\t\tthis.number = null;\n\t\tthis.init();\n\t}\n\n\tsetColor(color) {\n\t\tthis.area.setColor(color);\n\t}\n\n\tgetColor() {\n\t\treturn this.area.getColor();\n\t}\n\n\tsetGlobalRegions(regions) {\n\t\tthis.globalRegions = regions;\n\t}\n\n\trenderHex() {\n\t\tthis.area.draw();\n\t}\n\n\t/**\n\t * Draws Region and sets it up\n\t */\n\tinit() {\n\t\tfor (let i = 0; i < this.allowedCoordinates.length; ++i) {\n\t\t\tif (this.allowedCoordinates[i].allowed) {\n\t\t\t\tthis.area = new Hexagon(\n\t\t\t\t\tthis.allowedCoordinates[i].name,\n\t\t\t\t\tthis.canvas, this.allowedCoordinates[i].x,\n\t\t\t\t\tthis.allowedCoordinates[i].y,\n\t\t\t\t\tthis.color,\n\t\t\t\t\tthis.coordinate\n\t\t\t\t);\n\t\t\t\tthis.number = i;\n\t\t\t\tthis.neighbour = this.allowedCoordinates[i].neighbour;\n\t\t\t\tthis.label = this.allowedCoordinates[i].name;\n\t\t\t\tthis.allowedCoordinates[i].allowed = false;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tsetNeighbours(num) {\n\t\treachMatrix[num].forEach(temp => {\n\t\t\tif (temp === 1) {\n\t\t\t\tthis.neighbour.push(temp + 1);\n\t\t\t}\n\t\t});\n\t}\n\n\tsetBusListeners() {\n\t\tbus.on('update-neighbour', dict => {\n\t\t\tconst data = dict.payload;\n\t\t\t//debugger;\n\t\t\tif (data.from.name === this.name) {\n\t\t\t\tthis.removeNeighbour(data.to.name);\n\t\t\t} else if(data.to.name === this.name) {\n\n\t\t\t\tdata.from.owner.regions.forEach(temp => {\n\t\t\t\t\tthis.removeNeighbour(temp.name);\n\t\t\t\t});\n\t\t\t\tdata.to.owner.regions.forEach(temp => {\n\n\t\t\t\t\tif (reachMatrix[data.to.number][temp.number] === 1) {\n\t\t\t\t\t\tlet f = false;\n\t\t\t\t\t\tfor (let i = 0; i < data.to.neighbour.length; ++i) {\n\t\t\t\t\t\t\tif (data.to.neighbour[i] === temp.name)  {\n\t\t\t\t\t\t\t\tf = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (f === false) {\n\t\t\t\t\t\t\tdata.to.neighbour.push(temp.name);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t} else {\n\t\t\t\t// debugger;\n\t\t\t\tthis.globalRegions.forEach(region => {\n\t\t\t\t\tif (region.name === data.to.name) {\n\t\t\t\t\t\tif (reachMatrix[this.number][region.number] === 1) {\n\t\t\t\t\t\t\tlet f = false;\n\t\t\t\t\t\t\tfor (let i = 0; i < this.neighbour.length; ++i) {\n\t\t\t\t\t\t\t\tif (this.neighbour[i] === data.to.name) {\n\t\t\t\t\t\t\t\t\tf = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (f === false) {\n\t\t\t\t\t\t\t\tthis.neighbour.push(data.to.name);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tbus.on('change-move', data => {\n\t\t\t//todo какое то будущее, прослушал все((\n\t\t\tthis.gameData.units += 1000;\n\t\t});\n\t}\n\n\tremoveNeighbour(name) {\n\t\tthis.neighbour.forEach((cur, i) => {\n\t\t\tif (cur === name) {\n\t\t\t\tthis.neighbour.splice(i, 1);\n\t\t\t}\n\t\t});\n\t\tconsole.log(this.name, '  ', this.neighbour);\n\t}\n}","/**\n * Returns random number between min and max\n * @param min\n * @param max\n * @return {*}\n */\nconst getRandom = (min, max) => {\n\treturn Math.floor((Math.random() * (max - min))) + min;\n};\nexport default getRandom;","/* eslint-disable no-undef */\nimport Section from '../baseView.js';\nimport bus from '../../../modules/bus.js';\nimport Game from '../../../modules/game/game.js';\nimport Coordinate from '../../../modules/game/config/coordinate.js';\nimport {GameModes} from '../../../modules/game/config/modes.js';\n\nexport default class MultiplayerSection extends Section {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.parent = document.getElementById('game');\n\t\tthis.wrapper = document.createElement('div');\n\t\tthis.wrapper.classList.add('wrapper');\n\t\t//todo поменять где надо айдишники\n\n\t\tthis.wrapper.innerHTML += generateCanvas(\n\t\t\t{\n\t\t\t\t'width': window.innerWidth * 0.7,\n\t\t\t\t'height': window.innerWidth * 0.525 * 0.83,\n\t\t\t\t'id': 'multiplayer-canvas'\n\t\t\t}\n\t\t);\n\n\t\t// this.wrapper.getElementsByClassName('info-menu')[0].setAttribute('style', window.innerWidth * 0.525 * 0.83);\n\t\tthis.parent.appendChild(this.wrapper);\n\t\tthis.game_canvas = document.getElementById('multiplayer-canvas');\n\t\tthis.ctx = this.game_canvas.getContext('2d');\n\t}\n\n\trender() {\n\n\t\tthis.img = new Image();\n\t\tthis.img.src = '/map.png';\n\t\tthis.load = new Promise((resolve, reject) => {\n\t\t\tthis.img.onload = () => {\n\t\t\t\tresolve(this.ctx.drawImage(this.img, 0, 0, this.game_canvas.width, this.game_canvas.height));\n\t\t\t};\n\t\t});\n\t\tthis.load\n\t\t\t.then(\n\t\t\t\t() => {\n\t\t\t\t\tthis.setWindowResizeHandler();\n\t\t\t\t\tthis.coordinate = new Coordinate(this.game_canvas);\n\t\t\t\t\tthis.changeBut = this.wrapper.getElementsByClassName('change')[0];\n\t\t\t\t\tthis.game = new Game(GameModes.multiplayer, this.game_canvas, this.coordinate, this.changeBut, this.img);\n\t\t\t\t\t// this.game.start();\n\n\t\t\t\t}\n\t\t\t);\n\n\t\treturn this.wrapper;\n\t}\n\n\tallowed() {\n\t\treturn true;\n\t}\n\n\tcomputeCanvasSize() {\n\t\t// const size = (window.innerWidth > window.innerHeight) ? window.innerHeight : window.innerWidth;\n\t\treturn [window.innerWidth * 0.7, window.innerWidth * 0.525 * 0.83];\n\t}\n\n\tsetWindowResizeHandler() {\n\t\twindow.addEventListener('resize', () => {\n\t\t\t[this.game_canvas.width, this.game_canvas.height] = this.computeCanvasSize();\n\t\t\tthis.ctx.drawImage(this.img, 0, 0, this.game_canvas.width, this.game_canvas.height);\n\t\t\tthis.coordinate.reSize(this.game_canvas);\n\t\t\tbus.emit('resize-for-draw', {});\n\t\t});\n\t\treturn this;\n\t}\n}\n\n\n\n","'use strict';\n\nimport MultiplayerSection from './components/views/multiplayerView/multiplayerView.js';\nimport RegisterSection from './components/views/registerView/registerView.js';\nimport ProfileSection from './components/views/profileView/profileView.js';\nimport RatingSection from './components/views/ratingView/ratingView.js';\nimport LoginSection from './components/views/loginView/loginView.js';\nimport MenuSection from './components/views/menuView/menuView.js';\nimport GameSection from './components/views/gameView/gameView.js';\nimport User from './modules/userModel.js';\nimport Router from './modules/router.js';\n\nconst root = document.getElementById('application');\nconst globalRoot = document.getElementById('body');\n\n// if ('serviceWorker' in navigator) {\n// \tnavigator.serviceWorker.register('/sw.js', {scope: '/'})\n// \t\t.catch((err) => {\n// \t\t\tconsole.log('Service worker error: ' + err);\n// \t\t});\n// }\n\nUser.auth()\n\t.then( () => {\n\t\tnew Router(root, globalRoot)\n\t\t\t.add('/', MenuSection)\n\t\t\t.add('/register', RegisterSection)\n\t\t\t.add('/profile', ProfileSection)\n\t\t\t.add('/rating', RatingSection)\n\t\t\t.add('/multiplayer', MultiplayerSection)\n\t\t\t.add('/singleplayer', GameSection)\n\t\t\t.add('/login', LoginSection)\n\t\t\t.start();\n\t})\n\t.catch();\n","/**\n * @type {HTMLCollectionOf<Element>}\n */\n\nvar radar = document.getElementById( 'radar' ),\n\tdiameter = Math.min(document.getElementById( 'radar-wrapper' ).offsetHeight,document.getElementById( 'radar-wrapper' ).offsetWidth)-100,\n\tradius = diameter / 2,\n\tpadding = 14,\n\tctx = Sketch.create({\n\t\tcontainer: radar,\n\t\tfullscreen: false,\n\t\twidth: diameter,\n\t\theight: diameter\n\t}),\n\n\tdToR = function( degrees ){\n\t\treturn degrees * (Math.PI / 180);\n\t},\n\tsweepAngle = 270,\n\tsweepSize = 2,\n\tsweepSpeed = 1.2,\n\trings = 4,\n\thueStart = 120,\n\thueEnd = 170,\n\thueDiff = Math.abs( hueEnd - hueStart ),\n\tsaturation = 50,\n\tlightness = 40,\n\tlineWidth = 2,\n\tgradient = ctx.createLinearGradient( radius, 0, 0, 0 );\n\n\nradar.style.marginLeft = radar.style.marginTop = ( -diameter / 2 ) - padding + 'px';\ngradient.addColorStop( 0, 'hsla( ' + hueStart + ', ' + saturation + '%, ' + lightness + '%, 1 )' );\ngradient.addColorStop( 1, 'hsla( ' + hueEnd + ', ' + saturation + '%, ' + lightness + '%, 0.1 )' );\n\nvar renderRings = function(){\n\tvar i;\n\tfor( i = 0; i < rings; i++ ){\n\t\tctx.beginPath();\n\t\tctx.arc( radius, radius, ( ( radius - ( lineWidth / 2) ) / rings) * ( i + 1 ), 0, TWO_PI, false );\n\t\tctx.strokeStyle = 'hsla(' + ( hueEnd - ( i * ( hueDiff / rings ) ) ) + ', ' + saturation + '%, ' + lightness + '%, 0.1)';\n\t\tctx.lineWidth = lineWidth;\n\t\tctx.stroke();\n\t};\n};\n\nvar renderGrid = function(){\n\tctx.beginPath();\n\tctx.moveTo( radius - lineWidth / 2, lineWidth );\n\tctx.lineTo( radius - lineWidth / 2, diameter - lineWidth );\n\tctx.moveTo( lineWidth, radius - lineWidth / 2 );\n\tctx.lineTo( diameter - lineWidth, radius - lineWidth / 2 );\n\tctx.strokeStyle = 'hsla( ' + ( ( hueStart + hueEnd ) / 2) + ', ' + saturation + '%, ' + lightness + '%, .03 )';\n\tctx.stroke();\n};\n\nvar renderSweep = function(){\n\tctx.save();\n\tctx.translate( radius, radius );\n\tctx.rotate( dToR(sweepAngle) );\n\tctx.beginPath();\n\tctx.moveTo( 0, 0 );\n\tctx.arc( 0, 0, radius, dToR( -sweepSize ), dToR( sweepSize ), false );\n\tctx.closePath();\n\tctx.fillStyle = gradient;\n\tctx.fill();\n\tctx.restore();\n};\n\nvar renderScanLines = function(){\n\tvar i;\n\tvar j;\n\tctx.beginPath();\n\tfor( i = 0; i < diameter; i += 2 ){\n\t\tctx.moveTo( 0, i + .5 );\n\t\tctx.lineTo( diameter, i + .5);\n\t};\n\tctx.lineWidth = 1;\n\tctx.strokeStyle = 'hsla( 0, 0%, 0%, .02 )';\n\tctx.globalCompositeOperation = 'source-over';\n\tctx.stroke();\n};\n\nctx.clear = function(){\n\tctx.globalCompositeOperation = 'destination-out';\n\tctx.fillStyle = 'hsla( 0, 0%, 0%, 0.1 )';\n\tctx.fillRect( 0, 0, diameter, diameter );\n};\n\nctx.update = function(){\n\tsweepAngle += sweepSpeed;\n};\n\nctx.draw = function(){\n\tctx.globalCompositeOperation = 'lighter';\n\trenderRings();\n\trenderGrid();\n\trenderSweep();\n\trenderScanLines();\n};","import '../public/css/reset.css';\nimport '../public/css/main.css';\nimport '../public/js/components/blocks/input/input.css';\nimport '../public/js/components/blocks/button.css';\nimport '../public/js/components/blocks/decorations/lamp.css';\nimport '../public/js/components/blocks/decorations/plank.css';\nimport '../public/js/components/blocks/decorations/screw.css';\nimport '../public/js/components/views/ratingView/rating.css';\nimport '../public/js/components/views/profileView/profile.css';\nimport '../public/js/components/forms/loadPictureForm/loadPictureForm.css';\nimport '../public/js/components/views/menuView/menu.css';\nimport '../public/js/components/views/ViewsBack.css';\nimport '../public/js/components/radar/radar.css';\nimport '../public/js/components/views/gameView/gameView.css';\n\n// import '../public/js/modules/sketch.js';\nimport '../public/js/components/radar/radar.js';\nimport '../public/js/application.js';\n"],"sourceRoot":""}